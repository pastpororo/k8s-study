## Adding a readiness probe
```bash
# Chapter03/3.2 â€˜deploy/serviceâ€™ ì½”ë“œ ë‚´ìš© ë°°í¬ : kind ì‹¤ìŠµ í™˜ê²½ì— ë§ê²Œ ì¼ë¶€ ìˆ˜ì •
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: timeserver
spec:
  replicas: 3
  selector:
    matchLabels:
      pod: timeserver-pod
  template:
    metadata:
      labels:
        pod: timeserver-pod
    spec:
      containers:
      - name: timeserver-container
        image: docker.io/wdenniss/timeserver:1
---
apiVersion: v1
kind: Service
metadata:
  name: timeserver
spec:
  selector:
    pod: timeserver-pod
  ports:
  - port: 80
    targetPort: 80
    protocol: TCP
    nodePort: 30000
  type: NodePort
EOF

# ë°°í¬ ì •ë³´ í™•ì¸
kubectl get deploy,svc,ep timeserver -o wide

# íŒŒë“œ ì •ë³´ ë¼ë²¨ í•„í„°ë§
kubectl get pods -l pod=timeserver-pod -owide

# ì ‘ì† ì‹œë„
curl http://localhost:30000
curl http://localhost:30000

# ë¡œê·¸ í™•ì¸
kubectl logs deploy/timeserver
kubectl logs -f deploy/timeserver

# (ì‹ ê·œ í„°ë¯¸ë„) ë°˜ë³µ ì ‘ì† ì‹œë„
while true; do curl -s --connect-timeout 1 http://127.0.0.1:30000 ; sleep 0.5 ; done
while true; do curl -s --connect-timeout 1 http://127.0.0.1:30000 ; sleep 1   ; done
í˜¹ì€
watch -n 0.25 -d curl -s --connect-timeout 1 "http://127.0.0.1:30000"
watch -n 1    -d curl -s --connect-timeout 1 "http://127.0.0.1:30000"
```


# Probe types

```bash
## HttpGet
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-http
spec:
  containers:
  - name: liveness
    image: registry.k8s.io/e2e-test-images/agnhost:2.40
    args:
    - liveness
    livenessProbe:
      httpGet:
        path: /healthz
        port: 8080
        httpHeaders:
        - name: Custom-Header
          value: Awesome
      initialDelaySeconds: 3
      periodSeconds: 3

## TcpSocket : tcp ì‚¬ìš© ì„œë¹„ìŠ¤ì— ì ìš© ê¶Œì¥ - Docs
apiVersion: v1
kind: Pod
metadata:
  name: goproxy
  labels:
    app: goproxy
spec:
  containers:
  - name: goproxy
    image: registry.k8s.io/goproxy:0.1
    ports:
    - containerPort: 8080
    readinessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 10
    livenessProbe:
      tcpSocket:
        port: 8080
      initialDelaySeconds: 15
      periodSeconds: 10

## gRPC - Docs
apiVersion: v1
kind: Pod
metadata:
  name: etcd-with-grpc
spec:
  containers:
  - name: etcd
    image: registry.k8s.io/etcd:3.5.1-0
    command: [ "/usr/local/bin/etcd", "--data-dir",  "/var/lib/etcd", "--listen-client-urls", "http://0.0.0.0:2379", "--advertise-client-urls", "http://127.0.0.1:2379", "--log-level", "debug"]
    ports:
    - containerPort: 2379
    livenessProbe:
      grpc:
        port: 2379
      initialDelaySeconds: 10

## Exec(Command , Bash Script) - Docs
apiVersion: v1
kind: Pod
metadata:
  labels:
    test: liveness
  name: liveness-exec
spec:
  containers:
  - name: liveness
    image: registry.k8s.io/busybox
	    args:
    - /bin/sh
    - -c
    - touch /tmp/healthy; sleep 30; rm -f /tmp/healthy; sleep 600
    livenessProbe:
      exec:
        command:
        - cat
        - /tmp/healthy
      initialDelaySeconds: 5
      periodSeconds: 5
```

![alt text](image.png)
```bash
1. [System] App is initializing : *App ì´ˆê¸°í™”*
2. [Kubernetes] startupProbe is Failed â†’ [System] isAppLive: false *â‡’ startupProbe ì‹œì‘ â†’ ì‹¤íŒ¨*
3. [System] Database is connecting *â‡’ DB ì—°ê²° ì‹œë„*
4. [System] Database is connected *â‡’ DB ì—°ê²° ì„±ê³µ*
5. [System] App is starting *â‡’ App ì‹œì‘, ì´ë•Œê¹Œì§€ startupProbe ì‹¤íŒ¨*
6. [Kubernetes] startupProbe is Succeed â†’ [System] isAppLive: true ***â‡’  App Live ë™ì‘, startupProbe ì„±ê³µ!***
7. [Kubernetes] readinessProbe is Failed â†’ [System] isAppReady: false *â‡’ ì™¸ë¶€ì˜ì¡´ì„±fail, readinessProbe ì‹œì‘ â†’ ì‹¤íŒ¨*
8. [Kubernetes] livenessProbe is Succeedâ†’ [System] isAppLive: true ***â‡’ livenessProbe ì‹œì‘ â†’ ì„±ê³µ!***
9. [System] ConfigMap data is loading.. *â‡’ ì»¨í”¼ê·¸ë§µ ë°ì´í„° ë¡œë”© ì‹œë„ : ì™¸ë¶€ì˜ì¡´ì„± ì—°ê²° ë° ì¸ì¦ ì •ë³´*
10. [System] Data loading is completed *â‡’ ì»¨í”¼ê·¸ë§µ ë°ì´í„° ë¡œë”© ì™„ë£Œ*
11. [Kubernetes] readinessProbe is Failed â†’ [System] isAppReady: false *â‡’ ì™¸ë¶€ì˜ì¡´ì„±fail, readinessProbe ì‹¤íŒ¨*
12. Started AppApplication in 62.631 seconds (process running for 66.206) *â‡’ ì™¸ë¶€ì˜ì¡´ì„±ok â†’ App ëª¨ë“  ë™ì‘ ìˆ˜í–‰ ê°€ëŠ¥ ìƒíƒœ*
13. [Kubernetes] readinessProbe is Succeed â†’ [System] isAppReady: true ***â‡’ ì™¸ë¶€ì˜ì¡´ì„±ok, readinessProbe ì„±ê³µ***
```


## Probe ê¶Œì¥ ì„¤ì •
- **ì¼ì‹œì  ì¥ì•  ìƒí™©** : **livenessProbeì˜ ì‹¤íŒ¨ ì‹œê°„ì„ ê¸¸ê²Œ ì„¤ì •**í•´ì„œ íŒŒë“œê°€ ì‰½ê²Œ ì¬ê¸°ë™ ë˜ëŠ” ê±¸ **ë°©ì§€**      
    - â‡’ **readiness** ëŠ” í•´ë‹¹ íŒŒë“œê°€ EPì œì™¸ë˜ë„ íƒ€íŒŒë“œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹ˆ **ë¯¼ê°**í•˜ê²Œ ì²´í¬í•˜ê³ ,
    - â‡’ **liveness**ëŠ” íŒŒë“œ ì¬ê¸°ë™ ì‹œ ê¸°ì¡´ í˜¸ì¶œ ì²˜ë¦¬ ìœ ì‹¤ì´ë‚˜ ì‹œê°„ì´ ì§€ë‚˜ ìì—° í•´ì†Œ ìƒíƒœì˜ ê¸°íšŒë¥¼ ë¹¼ì•—ê³  ì˜¤íˆë ¤ ë¬´í•œ ì¬ê¸°ë™ ë ìˆ˜ ìˆìœ¼ë‹ˆ **ë„ë„**í•˜ê²Œ ì²´í¬!

- **ê¶Œì¥ ì„¤ì •** : ì¼ì‹œì  ì¥ì•  ìƒí™©(App ë‚´ë¶€ ë¶€í•˜ ì¦ê°€)ê°€ ì‹œì‘ ëœ í›„, 30ì´ˆ ë’¤ì— íŠ¸ë˜í”½ì´ ì¤‘ë‹¨ë˜ê³ , 3ë¶„ ë’¤ì—ëŠ” Appì´ ì¬ê¸°ë™ ë˜ë„ë¡ ì„¤ì •í•´ ë³´ì„¸ìš”.
    - (ì•„ë˜ APIë¥¼ ë‚ ë¦¬ë©´ readinessProbeì™€ livenessProbeê°€ ë™ì‹œì— ì‹¤íŒ¨í•˜ê²Œ ë©ë‹ˆë‹¤)
    - livenessProbeì— periodSecondsë‚˜ failureThresholdë¥¼ ëŠ˜ë¦¬ë©´ ë©ë‹ˆë‹¤
```bash
# ë¶€í•˜ ì¦ê°€ API - (App ë‚´ë¶€ isAppReadyì™€ isAppLiveë¥¼ Falseë¡œ ë°”ê¿ˆ)
curl http://localhost:30000/server-load-on ; echo

# Deployment ì— livenessProbeì— periodSecondsë‚˜ failureThresholdë¥¼ ëŠ˜ë¦¬ë©´ ë©ë‹ˆë‹¤.
kubectl edit deployments.apps -n anotherclass-123 api-tester-1231
...
startupProbe:
  httpGet:
    path: "/startup"
    port: 8080
  periodSeconds: 5
  failureThreshold: 10
readinessProbe:
  httpGet:
    path: "/readiness"
    port: 8080
  periodSeconds: 10 # ë¯¼ê°í•˜ê²Œ
  failureThreshold: 3
livenessProbe:
  httpGet:
    path: "/liveness"
    port: 8080
  periodSeconds: 60 # ë„ë„í•˜ê²Œ
  failureThreshold: 3
...
```


# Updating live applications : ì—…ë°ì´íŠ¸ ì „ëµ 3ê°€ì§€
**[1] Rolling update strategy**

- ê¸°ë³¸ ì „ëµì€ ë¡¤ë§ ì—…ë°ì´íŠ¸ : The default zero-downtime update strategy offered by Kubernetes is a **rolling update**.
![alt text](image-2.png)
- **ë¡¤ë§ ì—…ë°ì´íŠ¸ ì „ëµ ëª©í‘œ**
    - ì§€ì†ì ì¸ ì„œë¹„ìŠ¤ ì œê³µ : Providing continuous uptime during the rollout
    - ì—…ë°ì´íŠ¸ ì¤‘ ìµœì†Œí•œì˜ (ì„œë²„)ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ ì‚¬ìš© : Using as few extra resources as possible during the update
- ë¡¤ë§ ì—…ë°ì´íŠ¸ëŠ” ìƒˆ ë²„ì „ íŒŒë“œë¨¼ì € ìƒì„±(ì‚¬ì´ì¦ˆ ìˆ˜ì • ê°€ëŠ¥) í•˜ê³  ì •ìƒ ì‹œ ì´ì „ íŒŒë“œë¥¼ ì¢…ë£Œë¥¼ ë°˜ë³µ : In a rolling update, Pods with the new version are created in groups (the size of which is tunable). Kubernetes waits for the new group of Pods to become available and then terminates the same number of Pods running the old version, repeating this until all Pods are running the new version (figure 4.2).
- ê³¼ì • ì¤‘ ë‘ ë²„ì „ì´ ê³µì¡´ : Importantly, with this strategy, the two versions of your application (old and new) need to be able to coexist as they will both be running for a time.
- ë°±ì—”ë“œ ë° ê¸°íƒ€ ì¢…ì†ì„±ì—ì„œ ë‘ ë²„ì „ ì²˜ë¦¬í•  ìˆ˜ ìˆì–´ì•¼ í•˜ë©°, ì‚¬ìš©ìëŠ” ë‹¤ë¥¸ ë²„ì „ì˜ ìš”ì²­ì„ ë°›ì„ ìˆ˜ ìˆìŒ : That is, your backend or any other dependencies must be able to handle these two different versions, and users may get alternating versions when they make different requests. Imagine reloading the page and seeing the new version and then reloading it and seeing the old version again.
- ë³µì œë³¸ì´ ë§ì„ ê²½ìš° ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŒ, ë¬¼ë¡  ë¡¤ë°± ì‹œì—ë„ : Depending on how many replicas you have, a rolling update can take a while to complete (and, therefore, any rollback can also take a while).

- **maxSurge** ì™€ **maxUnavailable** ë¡œ ë¡¤ì•„ì›ƒ ì†ë„ ì¡°ì ˆ ê°€ëŠ¥ : Letâ€™s configure our Deployment to use the rolling update strategy in the following listing. The options maxSurge and maxUnavailable can be used to govern how quickly the rollout happens.

**MaxSurge**

- ë¡¤ë§ ê¸°ê°„ ì¶”ê°€ë¡œ ìƒì„± í•  ìˆ˜ ìˆëŠ” íŒŒë“œ ê°¯ìˆ˜ : maxSurge governs how many additional Pods youâ€™re willing to create during the rollout.
- For example, if you set a replica count of 5, and a maxSurge of 2, then it may be possible to have seven Pods (of different versions) scheduled.
- ë†’ì„ ìˆ˜ë¡ ì—…ë°ì´íŠ¸ ë„ì¤‘ ë¦¬ì†ŒìŠ¤ë¥¼ ì¢€ ë” ì‚¬ìš©ë¨ : The tradeoff is that the higher this number is, the faster the rollout will complete, but the more resources it will (temporarily) use.
- If youâ€™re highly optimizing your costs, you could set maxSurge to 0.
- ëŒ€ê·œëª¨ ê²½ìš° ë¡¤ë§ ì—…ë°ì´íŠ¸ì— ì—¬ëŸ¬ ì„œë²„ë“¤ë¡œ ì—…ë°ì´íŠ¸ í›„ ì™„ë£Œ ë˜ë©´ ì„œë²„ë“¤ì„ ì¶•ì†Œë„ ê°€ëŠ¥ : Alternatively, for a large deployment, you could temporarily increase the resources available in your cluster during the rollout by adding nodes and removing them when the rollout is complete.

**MaxUnavailable**

- ì—…ë°ì´íŠ¸ ë„ì¤‘ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ìµœëŒ€ íŒŒë“œ ìˆ˜ : maxUnavailable sets the maximum number of Pods that can be unavailable during updates (percentage values are also accepted and are rounded down to the nearest integer).
- If youâ€™ve tuned your replica count to handle your expected traffic, you may not want to set this value much higher than 0, as your service quality could degrade during updates.
- The tradeoff here is that the higher the value, the more Pods can be replaced at once and the faster the rollout completes, while temporarily reducing the number of ready Pods that are able to process traffic.
- A rollout could coincide with another event that lowers availability, like a node failure.
- ìƒìš© í™˜ê²½ì—ì„œëŠ” 0ì„ ê¶Œì¥ : Thus, for production workloads, I recommend setting maxUnavailable to 0.
- 0 ì„¤ì • ì‹œ ìŠ¤ì¼€ì¤„ ê°€ëŠ¥ ë…¸ë“œê°€ ì—†ìœ¼ë©´, ë¡¤ì•„ì›ƒ ì¤‘ë‹¨ë˜ê³  íŒŒë“œëŠ” ë³´ë¥˜ ìƒíƒœê°€ ë¨ì— ì£¼ì˜ : The caveat is that if you set it to 0 and your cluster has no schedulable resources, the rollout will get stuck, and you will see Pods in the Pending state until resources become available.
- When maxUnavailable is 0, maxSurge cannot also be 0 because, to preserve the full availability, the system needs to temporarily increase the replica count to allow time for the new Pods to become ready.

**Recommendation**

- A rolling update is a good go-to strategy for most services.
- **ìƒìš© í™˜ê²½ì—ì„œëŠ” maxUnavailable 0ì„ ê¶Œì¥** :  For production services, maxUnavailable is best set to 0.
- **ì—¬ìœ  ë…¸ë“œ ìì›ì´ ìˆê³  ë¹ ë¥¸ ë¡¤ë§ ì†ë„ë¥¼ ìœ„í•´ì„œ maxSurgeëŠ” 1 ì´ìƒ**ì´ì–´ì•¼ ë¨ : maxSurge should be at least 1, or higher if you have enough spare capacity and want faster rollouts.
    
    

**Deploying Changes with a Rolliing Update**

- Once your Deployment is configured to use a rolling update, deploying your changes is as simple as updating the Deployment manifest (e.g., with a new container version) and applying the changes with kubectl apply.
- Most changes made to the Deployment, including readiness and liveness checks, are also versioned and will be rolled out just like a new container image version.
- í•„ìš” ì‹œ ê°•ì œ ë¡¤ì•„ì›ƒ ì‹¤í–‰ ê°€ëŠ¥ : If you ever need, you can also force a rollout without changing anything in the Deployment object with kubectl rollout restart deploy $DEPLOYMENT_NAME.

**[2] Re-create strategy**

- **ê¸°ë³¸ ë²„ì „ ì‚­ì œí•˜ê³  ì‹ ê·œ ë²„ì „ ë°°í¬** : Another approachâ€”some might say, the old-fashion approachâ€”is to cut the application over directly, deleting all Pods of the old version and scheduling replacements of the new version.
- ì¬ìƒì„± ì¤‘ ì„œë¹„ìŠ¤ ì¥ì•  ë°œìƒ : Unlike the other strategies discussed here, this approach is not a zerodowntime one. It will almost certainly result in some unavailability (figure 4.3).
- With the right readiness checks in place, this downtime could be as short as the time to boot the first Pod, assuming it can handle the client traffic at that moment in time.
- ì¥ì ì€ ì¶”ê°€ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ ë¶ˆí•„ìš”, ì´ì „ ë²„ì „ê³¼ í˜¸í™˜ì„± ì¤€ë¹„ ë¶ˆí•„ìš” : The benefit of this strategy is that it does not require compatibility between the new version and the old version (since the two versions wonâ€™t be running at the same time), and it doesnâ€™t require any additional compute capacity (since itâ€™s a direct replacement).
- ë³´í†µ ê°œë°œ/ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ ì‚¬ìš© : This strategy may be useful for development and staging environments to avoid needing to overprovision compute capacity to handle rolling updates, and to increase speed, but otherwise, it should generally be avoided.
- To use this, in the strategy field given in listing 4.6, you would instead declare:

![alt text](image-3.png)

**[3] Blue/Green strategy**

- **ê¸°ì¡´ê³¼ ì‹ ê·œ ë²„ì „ì´ í•¨ê»˜ ë°°í¬** : The blue/green strategy is a rollout strategy where the new application version is deployed alongside the existing version (figure 4.4).
- **ìƒˆ ë²„ì „ì´ ì™„ì „íˆ ë°°í¬ ë° í…ŒìŠ¤íŠ¸ ê°€ëŠ¥** : These versions are given the names â€œblueâ€ and â€œgreen.â€ When the new version is fully deployed, tested, and ready to go, the service is cut over.
- ë¬¸ì œ ë°œìƒì„ ì¤„ì¼ ìˆ˜ ìˆìŒ : If thereâ€™s a problem, it can be immediately cut back.
- ìƒˆ ë²„ì „ì´ ê²€ì¦ ì™„ë£Œ í›„ ê¸°ë³¸ ë²„ì „ ì‚­ì œ(ìë™, ìˆ˜ë™ - ì‚¬ëŒ ìŠ¹ì¸ ê°€ëŠ¥) : After a time, if everything looks good, the old version can be removed. Unlike the prior two strategies, the old version remains ready to serve and is removed only when the new version is validated (and often with a human decision involved).

![alt text](image-4.png)

- **ì¥ì **
    - ì¼ê´€ëœ ì‚¬ìš©ì ê²½í—˜ì„ ìœ„í•´ í•œë²ˆì— í•œ ë²„ì „ ì•±ë§Œ ì‹¤í–‰ : Only one version of the app is running at a time for a consistent user experience.
    - ë¡¤ì•„ì›ƒ ì‹œ ì†ë„ê°€ ë¹ ë¦„ : The rollout is fast (within seconds).
    - ë§ˆì°¬ê°€ì§€ë¡œ ë¡¤ë°±ë„ ë¹ ë¦„ : Rollbacks are similarly fast.
- **ë‹¨ì **
    - ì¼ì‹œì ìœ¼ë¡œ ì»´í“¨íŒ… ë¦¬ì†ŒìŠ¤ 2ë°° ì†Œë¹„ : It temporarily consumes double the compute resources.
    - ì¿ ë²„ë„¤í‹°ìŠ¤ ë°°í¬ì—ì„œ ì§ì ‘ ì§€ì› ì•ˆë¨ â†’ êµ¬í˜„ì„ ìœ„í•´ì„œ ë‹¤ë¥¸ íˆ´ì´ë‚˜ ìˆ˜ì‘ì—… í•„ìš” : It is not supported directly by Kubernetes Deployments.

- **Summary**
    - KubernetesëŠ” ë°°í¬ë¥¼ ê³„ì† ì‹¤í–‰í•˜ê³  ì—…ë°ì´íŠ¸í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ë‹¤ì–‘í•œ ë„êµ¬ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
    - Kubernetesê°€ **ë©ˆì¶° ìˆê±°ë‚˜ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì¬ë¶€íŒ…í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê³„ì† ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì‹ í˜¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë„ë¡ ìƒíƒœ ì ê²€**ì„ ì •ì˜í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
    - KubernetesëŠ” Liveness probesë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¬ì‹œì‘í•´ì•¼ í•˜ëŠ” ì‹œê¸°ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.
    - readiness probeëŠ” ì„œë¹„ìŠ¤ë¡œë¶€í„° íŠ¸ë˜í”½ì„ ìˆ˜ì‹ í•˜ëŠ” ë³µì œë³¸ì„ ê´€ë¦¬í•˜ë©°, ì´ëŠ” ìš”ì²­ì´ ì¤‘ë‹¨ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì—…ë°ì´íŠ¸ ì¤‘ì— íŠ¹íˆ ì¤‘ìš”í•©ë‹ˆë‹¤
    - KubernetesëŠ” ë˜í•œ ë‹¤ìš´íƒ€ì„ ì—†ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—…ë°ì´íŠ¸í•˜ëŠ” ë° ë„ì›€ì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - ë¡¤ë§ì—…ë°ì´íŠ¸ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ ê¸°ë³¸ ë¡¤ì•„ì›ƒ ì „ëµìœ¼ë¡œ, ìµœì†Œí•œì˜ ì¶”ê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ì„œë„ ë‹¤ìš´íƒ€ì„ ì—†ì´ ë¡¤ì•„ì›ƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    - RecreateëŠ” ì¶”ê°€ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ì—†ì´ ì¼ë¶€ ë‹¤ìš´íƒ€ì„ìœ¼ë¡œ ì œìë¦¬ ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ëŒ€ì²´ ë¡¤ì•„ì›ƒ ì „ëµì…ë‹ˆë‹¤.
    - ë¸”ë£¨/ê·¸ë¦°ì€ ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì§ì ‘ ì§€ì›í•˜ì§€ëŠ” ì•Šì§€ë§Œ í‘œì¤€ ì¿ ë²„ë„¤í‹°ìŠ¤ ì»¨ìŠ¤íŠ¸ëŸ­íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë¡¤ì•„ì›ƒ ì „ëµì…ë‹ˆë‹¤.
    - ë¸”ë£¨/ê·¸ë¦°ì€ ìµœê³  í’ˆì§ˆì˜ ë³´ì¦ì„ ì œê³µí•˜ì§€ë§Œ ë” ë³µì¡í•˜ê³  ë°°í¬ì— í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì¼ì‹œì ìœ¼ë¡œ ë‘ ë°°ë¡œ ëŠ˜ë¦½ë‹ˆë‹¤.



# 5. Resource management

**Chapter 5** helps you **right-size** your workload so it gets the **resources** it needs without wastage.

- Kubernetesê°€ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ í• ë‹¹í•˜ëŠ” ë°©ë²• How Kubernetes allocates the resources in your cluster
- í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë§Œ ìš”ì²­í•˜ë„ë¡ ì›Œí¬ë¡œë“œ êµ¬ì„±í•˜ê¸° Configuring your workload to request just the resources it needs
- ë¹„ìš© ëŒ€ë¹„ ì„±ëŠ¥ ë¹„ìœ¨ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ë¦¬ì†ŒìŠ¤ Overcommitting resources to improve your cost/performance ratio
    - ì¿ ë²„ë„¤í‹°ìŠ¤ì—ì„œëŠ” **ì˜¤ë²„ì»¤ë°‹**ì„ í†µí•´ ì‹¤ì œ ë¬¼ë¦¬ ìì›ë³´ë‹¤ ë” ë§ì€ ì–‘ì˜ ìì›ì„ í• ë‹¹í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µ
- í¬ë“œ ë³µì œë³¸ ìˆ˜ì™€ ë‚´ë¶€ ë™ì‹œì„± ê°„ì˜ ê· í˜• ë§ì¶”ê¸° Balancing the Pod replica count with internal concurrency

â†’ ì´ ì¥ì—ì„œëŠ” í¬ë“œê°€ ìì› ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ ê¸°ê³„ì— í• ë‹¹ë˜ëŠ” ë°©ë²•ê³¼ í¬ë“œê°€ í•„ìš”í•œ ìì›ì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ ì‹œìŠ¤í…œì— ì œê³µí•´ì•¼ í•˜ëŠ” ì •ë³´ì— ëŒ€í•´ ë‹¤ë£¹ë‹ˆë‹¤.

â†’ ë…¸ë“œì— í¬ë“œê°€ ì–´ë–»ê²Œ í• ë‹¹ë˜ëŠ”ì§€ ì•Œë©´ ë¦¬ì†ŒìŠ¤ ìš”ì²­, ë²„ìŠ¤íŠ¸, ì˜¤ë²„ ì»¤ë°‹, ê°€ìš©ì„± ë° ì‹ ë¢°ì„±ì— ëŒ€í•œ ë” ë‚˜ì€ ì•„í‚¤í…ì²˜ ê²°ì •ì„ ë‚´ë¦¬ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.


## Specifying Pod resources
ìŠ¤ì¼€ì¤„ëŸ¬ì—ê²Œ ë°°í¬ ë§¤ë‹ˆí˜ìŠ¤íŠ¸ì—ì„œ ë¦¬ì†ŒìŠ¤ ìš”ì²­(ë° ê¸°íƒ€ ì›Œí¬ë¡œë“œ ìœ í˜•)ì„ ì§€ì •í•˜ì—¬ ìŠ¤ì¼€ì¤„ë§ ê²°ì •ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤
ì§€ê¸ˆê¹Œì§€ ì´ ì±…ì˜ ì˜ˆì‹œë“¤ì€ ìì› ìš”êµ¬ ì‚¬í•­ì„ ëª…ì‹œí•˜ì§€ ì•Šì•˜ì§€ë§Œ, ìƒìš©í™˜ê²½ ë°°í¬ì˜ ê²½ìš° ì´ ì •ë³´ë¥¼ ì¶”ê°€í•´ì•¼ í•©ë‹ˆë‹¤.
CPU 1ì½”ì–´ì˜ 20%ì™€ ë©”ëª¨ë¦¬ 200MiBì´ í•„ìš”í•œ PodëŠ” ì•„ë˜ì™€ ê°™ì´ ì§€ì •ë©ë‹ˆë‹¤.

```bash
# ì‹¤ìŠµ Skip
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: timeserver
spec:
  replicas: 3
  selector:
    matchLabels:
      pod: timeserver-pod
  template:
    metadata:
      labels:
        pod: timeserver-pod
    spec:
      containers:
      - name: timeserver-container
        image: docker.io/wdenniss/timeserver:3
        resources:
          requests:
            cpu: 200m
            memory: 250Mi
EOF

kubectl get pod -l pod=timeserver-pod
kubectl describe pod -l pod=timeserver-pod
...
    Requests:
      cpu:        200m
      memory:     250Mi

```

- ì—¬ê¸° ì˜ˆì‹œì—ì„œ 200mëŠ” 200ë°€ë¦¬ì½”ì–´, ì¦‰ í•˜ë‚˜ì˜ ì½”ì–´ì˜ 20%ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- ë¶€ë™ ì†Œìˆ˜ì  ìˆ«ì(ì˜ˆ: 0.2)ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì§€ë§Œ, ì¿ ë²„ë„¤í‹°ìŠ¤ ì‹¤ë¬´ìë“¤ ì‚¬ì´ì—ì„œëŠ” **ë°€ë¦¬ì½”ì–´**ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¼ë°˜ì ì…ë‹ˆë‹¤.
- ë©”ëª¨ë¦¬ì˜ **Mi ì ‘ë¯¸ì‚¬ëŠ” ë©”ë¹„ë°”ì´íŠ¸(MiB)ë¥¼ ë‚˜íƒ€ë‚´ê³ , GiëŠ” ê¸°ë¹„ë°”ì´íŠ¸(1,024ì˜ ê±°ë“­ì œê³±)**ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
    - **Mê³¼ GëŠ” ë©”ê°€ë°”ì´íŠ¸ì™€ ê¸°ê°€ë°”ì´íŠ¸(1,000ì˜ ê±°ë“­ì œê³±)**ë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤.
- ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì •í•˜ëŠ” ê²ƒì€ Kubernetesê°€ ë…¸ë“œ ìš©ëŸ‰ì— Pod ìš”êµ¬ ì‚¬í•­ì„ ë§ì¶”ëŠ” ë° í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ì¤‘ìš”í•©ë‹ˆë‹¤.
- ì¼ë¶€ í¬ë“œì—ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì •í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì€ ë…¸ë“œì— ë‹¤ì†Œ ë¬´ì‘ìœ„ë¡œ ë°°ì¹˜ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.
- ê·¸ë¦¼ 5.4ì˜ ë‚˜ë€íˆ ë¹„êµí•´ ë³´ì„¸ìš”. ì™¼ìª½ì—ëŠ” ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ ë‘ ê°œì˜ ë…¸ë“œì— ë°°ì¹˜ëœ ë‹¤ì„¯ ê°œì˜ í¬ë“œê°€ ìˆê³ , ì˜¤ë¥¸ìª½ì—ëŠ” ì„¸ ê°œì˜ í¬ë“œì— ë¦¬ì†ŒìŠ¤ê°€ ì§€ì •ë˜ì§€ ì•Šì•„ ë‹¤ë¥¸ í¬ë“œì™€ ê°™ì€ ë…¸ë“œì— ë°°ì¹˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- ìì›ì´ ì§€ì •ë˜ì§€ ì•Šì•˜ì„ ë•Œ ë™ì¼í•œ 5ê°œì˜ í¬ë“œì— ëŒ€í•´ ë…¸ë“œ ìì›ì˜ ì ˆë°˜ì´ í• ë‹¹ëœ ê²ƒì„ í™•ì¸í•˜ì„¸ìš”.
- ì—¬ê¸°ì„œ ìœ„í—˜ì€ ë¦¬ì†ŒìŠ¤ ì‚¬ì–‘ì´ ì—†ëŠ” í¬ë“œê°€ ë¦¬ì†ŒìŠ¤ê°€ ë¶€ì¡±í•´ì§€ê±°ë‚˜ ë…¸ë“œì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ëª¨ë¦¬ë³´ë‹¤ ë” ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ë©´ í‡´ê±°ë‹¹í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì…ë‹ˆë‹¤.

![alt text](image-5.png)

- ì¿ ë²„ë„¤í‹°ìŠ¤ì˜ í¬ë“œ ë°°ì¹˜ëŠ” ì§€ê¸ˆê¹Œì§€ëŠ” ê½¤ ê°„ë‹¨í•˜ê²Œ ë“¤ë¦´ ìˆ˜ ìˆì§€ë§Œ, ìš°ë¦¬ëŠ” ìš”ì²­ì„ ë¦¬ì†ŒìŠ¤ì™€ í˜ì–´ë§í•˜ê³  ìˆì„ ë¿ì…ë‹ˆë‹¤.
- ì‚¬ì‹¤, í­ë°œí•  ìˆ˜ ìˆëŠ” ëŠ¥ë ¥, ì¦‰ ìš”ì²­ëœ ìì›ë³´ë‹¤ ë” ë§ì€ ìì›ì„ ì†Œë¹„í•˜ëŠ” ëŠ¥ë ¥ì— ëŒ€í•´ì„œëŠ” ê°„ë‹¨í•  ê²ƒì…ë‹ˆë‹¤.
- ëŒ€ë¶€ë¶„ì˜ ê²½ìš° í”„ë¡œì„¸ìŠ¤ì— í•„ìš”í•œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ í•„ìš”í•˜ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë…¸ë“œì˜ ë‹¤ë¥¸ í¬ë“œë“¤ì´ ì„ì‹œë¡œ ê·¸ ìš©ëŸ‰ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ë©´ ì¢‹ì§€ ì•Šì„ê¹Œìš”?
- ê·¸ê²ƒì´ ë°”ë¡œ Kubernetesê°€ ì œê³µí•˜ëŠ” ê²ƒì´ë©°, í•œê³„ë¡œ êµ¬ì„±ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
- í¬ë“œ(ë‹¤ìŒ ëª©ë¡ì— ìˆëŠ” ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ)ëŠ” ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìŠ¤ì¼€ì¤„ë§ì— ì‚¬ìš©í•œë‹¤ê³  ì„ ì–¸í•˜ê³ , í¬ë“œê°€ ìŠ¤ì¼€ì¤„ë§ë˜ê³  ì‹¤í–‰ë  ë•Œ ì‚¬ìš©ë˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì œí•œí•˜ëŠ” ì œí•œì„ ì„¤ì •í•©ë‹ˆë‹¤.

```bash
# ì‹¤ìŠµ Skip
cat <<EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: timeserver
spec:
  replicas: 3
  selector:
    matchLabels:
      pod: timeserver-pod
  template:
    metadata:
      labels:
        pod: timeserver-pod
    spec:
      containers:
      - name: timeserver-container
        image: docker.io/wdenniss/timeserver:3
        resources:
          requests:
            cpu: 200m
            memory: 250Mi
          limits:
            cpu: 300m
            memory: 400Mi
EOF

#
kubectl get pod -l pod=timeserver-pod
kubectl describe pod -l pod=timeserver-pod
...
    Limits:
      cpu:     300m
      memory:  400Mi
    Requests:
      cpu:        200m
      memory:     250Mi
```

- ë…¸ë“œì— í¬ë“œë¥¼ ë°°ì¹˜í•  ë•Œ ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” í¬ë“œì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ë§Œ ê³ ë ¤í•©ë‹ˆë‹¤(ìŠ¤ì¼€ì¤„ë§ ì‹œ ì œí•œì€ ì „í˜€ ê³ ë ¤ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤).
- ê·¸ëŸ¬ë‚˜ ìš”ì²­ê³¼ ì œí•œ ëª¨ë‘ í¬ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ì„±ëŠ¥ì— ì˜í–¥ì„ ë¯¸ì¹©ë‹ˆë‹¤.
- ì‹¤í–‰ë˜ë©´ ë©”ëª¨ë¦¬ ì œí•œì„ ì´ˆê³¼í•˜ëŠ” Podê°€ ì¬ì‹œì‘ë˜ê³ , CPU ì œí•œì„ ì´ˆê³¼í•˜ëŠ” Podê°€ ìŠ¤ë¡œí‹€ë©ë‹ˆë‹¤.
- ì´ëŸ¬í•œ ì‘ì—…ì€ kubeletì— ì˜í•´ ì§ì ‘ ë…¸ë“œì—ì„œ ì²˜ë¦¬ë©ë‹ˆë‹¤.
- ë¦¬ì†ŒìŠ¤ ê²½í•©ì´ ë°œìƒí•  ê²½ìš°, ë©”ëª¨ë¦¬ ìš”ì²­ì„ ì´ˆê³¼í•˜ëŠ” í¬ë“œëŠ” í‡´ê±°ë  ìˆ˜ ìˆìœ¼ë©°(í‡´ê±°ë¥¼ ìœ„í•´ í¬ë“œë¥¼ ì„ íƒí•˜ëŠ” ë°©ë²•ì€ ì„¹ì…˜ 5.1.3ì„ ì°¸ì¡°í•˜ì‹­ì‹œì˜¤), CPU ìš”ì²­ì„ ì´ˆê³¼í•˜ëŠ” í¬ë“œëŠ” ìš”ì²­ëœ CPUë¡œ ìŠ¤ë¡œí‹€ë§ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ëŸ¬í•œ ê°’ì€ í¬ë“œê°€ ì˜ˆì•½ë˜ê³  ì‹¤í–‰ë˜ëŠ” ë°©ì‹ì— ë§¤ìš° ì¤‘ìš”í•œ ì—­í• ì„ í•˜ë¯€ë¡œ í¬ë“œì˜ ì»¨í…Œì´ë„ˆì— ëŒ€í•œ ìš”ì²­ê³¼ ì œí•œì„ ëª¨ë‘ ì„¤ì •í•˜ëŠ” ê²ƒì´ ìµœì„ ì˜ ë°©ë²•ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ê°’ì„ ì–´ë–»ê²Œ ì„¤ì •í•´ì•¼ í• ê¹Œìš”?
- ìš”ì²­ê³¼ ì œí•œì´ ìƒí˜¸ ì‘ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ í’ˆì§ˆ(QoS) í´ë˜ìŠ¤ë¥¼ í˜•ì„±í•˜ëŠ” ë°©ë²•ê³¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ì—¬ ì–´ë–¤ ê°’ì„ ì„¤ì •í• ì§€ ê²°ì •í•˜ëŠ” ë°©ë²•ì„ ì´í•´í•˜ë ¤ë©´ ê³„ì† ì½ì–´ë³´ì„¸ìš”.


## **5.1.2 Quality of service**

ìš”ì²­ë³´ë‹¤ ë†’ì€ ì œí•œì´ ìˆê±°ë‚˜ ì „í˜€ ì„¤ì •ë˜ì§€ ì•Šì€ ê²½ìš° ìƒˆë¡œìš´ ë¬¸ì œê°€ ë°œìƒí•©ë‹ˆë‹¤:
- ì´ í¬ë“œë“¤ì´ ë„ˆë¬´ ë§ì€ ìì›(ê°€ì¥ ì¼ë°˜ì ìœ¼ë¡œ, ë„ˆë¬´ ë§ì€ ë©”ëª¨ë¦¬)ì„ ì†Œë¹„í•˜ê³ , ìì›ì„ íšŒìˆ˜í•˜ê¸° ìœ„í•´ í‡´ê±°í•´ì•¼ í•  ë•ŒëŠ” ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”? ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ KubernetesëŠ” **ë¨¼ì € ì œê±°í•  í¬ë“œë¥¼ ìˆœìœ„** ë§¤ê¹ë‹ˆë‹¤.
    
- ì›Œí¬ë¡œë“œë¥¼ ê³„íší•  ë•Œ í•„ìš”í•œ ì„œë¹„ìŠ¤ì˜ ìê²©ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.
- KubernetesëŠ” ì„¸ ê°€ì§€ ì„œë¹„ìŠ¤ í’ˆì§ˆ ìˆ˜ì¤€ì„ ì œê³µ : **guaranteed, burstable, best effort**
    
**(1) Guaranteed Class**
    
ë³´ì¥ëœ í´ë˜ìŠ¤ í¬ë“œì—ì„œëŠ” **ì œí•œì´ ìš”ì²­ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •**ë©ë‹ˆë‹¤.
- **ì´ êµ¬ì„±ì€ Podê°€ ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ì¥í•˜ê¸° ë•Œë¬¸ì— ê°€ì¥ ì•ˆì •ì ì…ë‹ˆë‹¤.**
- í¬ë“œì— ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆê°€ ìˆëŠ” ê²½ìš°, í¬ë“œê°€ ë³´ì¦ ëŒ€ìƒìœ¼ë¡œ ê°„ì£¼ë˜ê¸° ìœ„í•´ì„œëŠ” ëª¨ë‘ ì´ ìš”ê±´ì„ ì¶©ì¡±í•´ì•¼ í•©ë‹ˆë‹¤.
- **ë³´ì¦ í´ë˜ìŠ¤ í¬ë“œëŠ” ë‹¤ì–‘í•œ ì¡°ê±´ì—ì„œ í•­ìƒ ë™ì¼í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì˜ˆì •ëœ ì‹œê°„ë³´ë‹¤ ë” ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ë…¸ë“œì—ì„œ í‡´ì¶œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.**
    
**(2) Burstable Class**
    
- ë²„ìŠ¤íŠ¸ ê°€ëŠ¥ í´ë˜ìŠ¤ í¬ë“œëŠ” ìš”ì²­ë³´ë‹¤ ë†’ì€ ì œí•œì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©°, ë¦¬ì†ŒìŠ¤ê°€ ì‚¬ìš© ê°€ëŠ¥í•œ ê²½ìš°(ì¦‰, ëª¨ë“  ìš”ì²­ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë‹¤ë¥¸ í¬ë“œë‚˜ ë…¸ë“œì—ì„œ í• ë‹¹ë˜ì§€ ì•Šì€ ê³µê°„) ì¼ì‹œì ìœ¼ë¡œ "ë²„ìŠ¤íŠ¸"í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ¬í•œ í¬ë“œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤
- ì‹¤ìˆ˜ë¡œ í­ë°œì— ì˜ì¡´í•˜ëŠ” ë“± ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í¬ë“œê°€ ë¹ˆ ë…¸ë“œì— ì°©ë¥™í•˜ì—¬ ë§ˆìŒê» í„°ì§ˆ ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.
- ê·¸ëŸ° ë‹¤ìŒ ë‚˜ì¤‘ì— ë¦¬ì†ŒìŠ¤ê°€ ì ì€ ë‹¤ë¥¸ ë…¸ë“œë¡œ ì¼ì •ì´ ë³€ê²½ë˜ì–´ ì´ì œ ì„±ëŠ¥ì´ ë‹¬ë¼ì§‘ë‹ˆë‹¤.
- ë”°ë¼ì„œ ë‹¤ì–‘í•œ ì¡°ê±´ì—ì„œ ë²„ìŠ¤íŠ¸ ê°€ëŠ¥í•œ í¬ë“œë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
- ì—¬ëŸ¬ ê°œì˜ ì»¨í…Œì´ë„ˆê°€ ìˆëŠ” í¬ë“œëŠ” ë³´ì¦ ë“±ê¸‰ ê¸°ì¤€ì„ ì¶©ì¡±í•˜ì§€ ëª»í•˜ê³  ìš”ì²­ ì„¸íŠ¸ê°€ ìˆëŠ” ì»¨í…Œì´ë„ˆê°€ ìˆëŠ” ê²½ìš° ë²„ìŠ¤íŠ¸ ê°€ëŠ¥í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼ë©ë‹ˆë‹¤.
- ì´ í¬ë“œë“¤ì€ ë©”ëª¨ë¦¬ì™€ ê°™ì€ ë¹„ì••ì¶•ì„± ìì›ì˜ ìš”ì²­ì„ ì´ˆê³¼í•˜ì§€ ì•ŠëŠ” í•œ í‡´ê±°ë¡œë¶€í„° ì•ˆì „í•©ë‹ˆë‹¤.
    
**(3) Best effort**
    
- ìš”ì²­ì´ë‚˜ ì œí•œì´ ì„¤ì •ë˜ì§€ ì•Šì€ í¬ë“œëŠ” "ìµœì„ ì˜ ë…¸ë ¥"ìœ¼ë¡œ ê°„ì£¼ë˜ë©° ì¿ ë²„ë„¤í‹°ìŠ¤ê°€ ì›í•˜ëŠ” ê³³ì— ì˜ˆì•½ë©ë‹ˆë‹¤.
- ì´ ì„¤ì •ì€ í´ë˜ìŠ¤ ì¤‘ ê°€ì¥ ë‚®ì€ ì„¤ì •ì´ë©°, ì´ íŒ¨í„´ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤.
- ë²„ìŠ¤íŠ¸ í´ë˜ìŠ¤ì—ì„œë„ ë§¤ìš° ë‚®ì€ ìš”ì²­ì„ ì„¤ì •í•˜ì—¬ ë¹„ìŠ·í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” ë‹¨ìˆœíˆ ëˆˆì„ ê°ê³  ìµœì„ ì„ ë°”ë¼ëŠ” ê²ƒ ì´ìƒì˜ ëª…í™•í•œ í‘œí˜„ì…ë‹ˆë‹¤.
- í¬ë“œì˜ ì•ˆì •ì„±ì„ ê³ ë ¤í•  ë•Œ, ìµœì†Œí•œ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì‹¤í–‰í•  ë¦¬ì†ŒìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆì„ ë§Œí¼ ë†’ì€ ê°’ìœ¼ë¡œ ì„¤ì •í•˜ê³  ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì „í˜€ ì„¤ì •í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ê°€ì¥ ì¢‹ìŠµë‹ˆë‹¤.
- ìš°ì„ ìˆœìœ„ê°€ ë†’ê³  ì¤‘ìš”í•œ ì›Œí¬ë¡œë“œëŠ” í•­ìƒ ì„±ëŠ¥ ë³´ì¥ ìš”ì²­ì— ì œí•œì„ ë‘ì–´ì•¼ í•©ë‹ˆë‹¤.
- **ì´ëŸ¬í•œ í¬ë“œëŠ” ë¦¬ì†ŒìŠ¤ ê²½í•© ì‹œ ë…¸ë“œì—ì„œ ê°€ì¥ ë¨¼ì € í‡´ì¶œë©ë‹ˆë‹¤.**
    
## **5.1.3 Evictions, priority, and preemption**
- ë©”ëª¨ë¦¬ì™€ ê°™ì€ ìœ í•œ ìì›ì˜ ìì› ê²½í•©(ì˜ˆ: ë„ˆë¬´ ë§ì€ í¬ë“œê°€ í•œ ë²ˆì— ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ë²„ìŠ¤íŠ¸í•˜ë ¤ê³  í•  ë•Œ)ì´ ë°œìƒí•˜ë©´, ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” í‡´ê±°ë¼ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ í†µí•´ ìš”ì²­ëœ í• ë‹¹ì„ ì´ˆê³¼í•˜ëŠ” ìì›ì„ ì‚¬ìš©í•˜ëŠ” í¬ë“œë¥¼ ì œê±°í•˜ì—¬ ìì›ì„ íšŒìˆ˜í•©ë‹ˆë‹¤.
- ë”°ë¼ì„œ í¬ë“œì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì ì ˆíˆ ì§€ì •í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.
- ë°°í¬ì™€ ê°™ì€ ê´€ë¦¬í˜• ì›Œí¬ë¡œë“œ êµ¬ì„±ì— ì†í•˜ëŠ” í‡´ê±°ëœ í¬ë“œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ë¥¸ ë…¸ë“œì—ì„œ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì¼ì •ì´ ë³€ê²½ë©ë‹ˆë‹¤.
- í•˜ì§€ë§Œ í¬ë“œê°€ ë„ˆë¬´ ìì£¼ í‡´ì¶œë˜ë©´ ì›Œí¬ë¡œë“œ ê°€ìš©ì„±ì´ ê°ì†Œí•  ìˆ˜ ìˆìœ¼ë©° ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ëŠ˜ë ¤ì•¼ í•œë‹¤ëŠ” ì‹ í˜¸ì…ë‹ˆë‹¤.
    
**Eviction**
    
- ë³´ì¥ëœ í´ë˜ìŠ¤ í¬ë“œëŠ” ìì› ê²½í•© ì‹œ í‡´ê±°ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ë°©íƒ„ ë°°í¬ë¥¼ ìœ„í•´ í•­ìƒ í¬ë“œì˜ í•œê³„ë¥¼ ìš”ì²­ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •í•˜ì—¬ ë³´ì¥ëœ ê²ƒìœ¼ë¡œ ì •ì˜í•˜ì„¸ìš”.
- ì´ ì„¹ì…˜ì˜ ë‚˜ë¨¸ì§€ ë¶€ë¶„ì—ì„œëŠ” í‡´ê±°ë¥¼ ê³ ë ¤í•  ë•Œ ë³´ì¥ë˜ì§€ ì•ŠëŠ” í¬ë“œì˜ ìˆœìœ„ê°€ ì–´ë–»ê²Œ ë§¤ê²¨ì§€ëŠ”ì§€, ê·¸ë¦¬ê³  ì£¼ë¬¸ì— ì–´ë–»ê²Œ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ ì„¤ëª…í•©ë‹ˆë‹¤.
- í‡´ê±°í•  í¬ë“œë¥¼ ì°¾ì„ ë•Œ, KubernetesëŠ” ë¨¼ì € ìš”ì²­ë³´ë‹¤ ë” ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í¬ë“œë¥¼ ê³ ë ¤í•˜ê³  ìš°ì„ ìˆœìœ„ ë²ˆí˜¸ì— ë”°ë¼ ì •ë ¬í•œ ë‹¤ìŒ, í¬ë“œê°€ ìš”ì²­í•œ ê²ƒ ì´ìƒì˜ ë¦¬ì†ŒìŠ¤(ê²½ìŸ ì¤‘ì¸ ë¦¬ì†ŒìŠ¤)ë¥¼ ì–¼ë§ˆë‚˜ ë” ë§ì´ ì‚¬ìš©í•˜ê³  ìˆëŠ”ì§€ì— ë”°ë¼ ì •ë ¬í•©ë‹ˆë‹¤.
- **best effort QoS í´ë˜ìŠ¤ í¬ë“œ**ëŠ” ìì› ìš”ì²­ì´ ì—†ê¸° ë•Œë¬¸ì— **ê°€ì¥ ë¨¼ì € í‡´ì¶œë©ë‹ˆë‹¤(ê°€ì¥ ë§ì€ ìì›ì„ ì‚¬ìš©í•˜ëŠ” í¬ë“œë¶€í„°).**
- ê¸°ë³¸ì ìœ¼ë¡œ ë™ì¼í•œ ìš°ì„ ìˆœìœ„ ë²ˆí˜¸(0)ì˜ ëª¨ë“  í¬ë“œì™€ ë™ì¼í•œ ìš°ì„ ìˆœìœ„ì˜ í¬ë“œì— ëŒ€í•´, ìœ„ì˜ ìš”ì²­ ì‚¬ìš©ëŸ‰ì€ ê·¸ë¦¼ 5.5ì™€ ê°™ì´ ìˆœìœ„ë¥¼ ë§¤ê¸°ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

![alt text](image-7.png)

## **priority**

- ìš°ì„ ìˆœìœ„ëŠ” ìˆœìœ„ë¥¼ ë³€ê²½í•˜ê¸° ìœ„í•´ **ìš°ì„ ìˆœìœ„ í´ë˜ìŠ¤**ë¥¼ í†µí•´ í¬ë“œì— í• ë‹¹í•  ìˆ˜ ìˆëŠ” **ì •ìˆ˜(0ì—ì„œ 1,000,000,000 ì‚¬ì´)ì…ë‹ˆë‹¤. ë†’ì„ ìˆ˜ë¡ ì¢‹ìŒ!**
- ê·¸ë¦¼ 5.6ì€ ê·¸ë¦¼ 5.5ì—ì„œ í¬ë“œì— **ìš°ì„ ìˆœìœ„ ë²ˆí˜¸ê°€ í• ë‹¹ëœ ê²½ìš°ì˜ í‡´ê±° ìˆœì„œ**ë¥¼ ë³´ì—¬ì¤ë‹ˆë‹¤.
- ë³´ì‹œë‹¤ì‹œí”¼, **í‡´ê±°ëŠ” ë¨¼ì € ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì •ë ¬**ëœ ë‹¤ìŒ **ìš”ì²­ ì´ìƒì˜ ì‚¬ìš©ëŸ‰ì— ë”°ë¼ ì •ë ¬**ë©ë‹ˆë‹¤.
- **ìš”ì²­ë³´ë‹¤ ë” ë§ì´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” í¬ë“œëŠ” ìš°ì„ ìˆœìœ„ì— ê´€ê³„ì—†ì´ í‡´ê±°ì˜ ìœ„í—˜ì´ ì—†ìŠµë‹ˆë‹¤.**

![alt text](image-8.png)

- To create your own priority level, you need to first create a **PriorityClass object.**
- Then assign the PriorityClass object to a **Pod**.

```bash
# create a PriorityClass object.
# A high priority class definition that does not preempt running Pods
cat << EOF | kubectl apply -f -
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: high-priority
value: 1000000
preemptionPolicy: Never # ì´ ìš°ì„ ìˆœìœ„ í´ë˜ìŠ¤ëŠ” í´ëŸ¬ìŠ¤í„°ì— ì‚¬ìš© ê°€ëŠ¥í•œ ìš©ëŸ‰ì´ ì—†ëŠ” ê²½ìš° ìš°ì„ ìˆœìœ„ê°€ ë‚®ì€ í¬ë“œë¥¼ í‡´ê±°ì‹œí‚¤ì§€ ì•ŠìŠµë‹ˆë‹¤
globalDefault: false
description: "Critical services."
EOF

#
kubectl get priorityclass
NAME                      VALUE        GLOBAL-DEFAULT   AGE   PREEMPTIONPOLICY
high-priority             1000000      false            5s    Never
system-cluster-critical   2000000000   false            10m   PreemptLowerPriority
system-node-critical      2000001000   false            10m   PreemptLowerPriority

# Then assign the PriorityClass object to a Pod.
# A Deployment that uses a priority class
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: timeserver
spec:
  replicas: 3
  selector:
    matchLabels:
      pod: timeserver-pod
  template:
    metadata:
      labels:
        pod: timeserver-pod
    spec:
      priorityClassName: high-priority
      containers:
      - name: timeserver-container
        image: docker.io/wdenniss/timeserver:1
        resources:
          requests:
            cpu: 200m
            memory: 250Mi
EOF

#
kubectl describe deployments.apps timeserver | grep Priority
  Priority Class Name:  high-priority

kubectl describe pod -l pod=timeserver-pod | grep -i qos
QoS Class:                   Burstable

# í™•ì¸ í›„ ì‚­ì œ
kubectl delete deploy timeserver
```

- ìš°ì„ ìˆœìœ„ ë²ˆí˜¸ëŠ” ì˜ˆì•½ ì‹œì—ë„ ì‚¬ìš©ë©ë‹ˆë‹¤.
- ì˜ˆì•½ ëŒ€ê¸° ì¤‘ì¸ í¬ë“œê°€ ë§ìœ¼ë©´ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ í¬ë“œë¥¼ ë¨¼ì € ì˜ˆì•½í•©ë‹ˆë‹¤.
- ìš°ì„ ìˆœìœ„ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤ì¼€ì¤„ë§ ìˆœì„œë¥¼ ê´€ë¦¬í•˜ëŠ” ê²ƒì€ ì–´ë–¤ ë°°ì¹˜ ì‘ì—…ì„ ë¨¼ì € ì‹¤í–‰í• ì§€ ìˆœìœ„ë¥¼ ë§¤ê¸°ëŠ” ë° íŠ¹íˆ ìœ ìš©í•©ë‹ˆë‹¤ (**ë°°ì¹˜ ì‘ì—…ì€ 10ì¥**ì—ì„œ ë‹¤ë£¹ë‹ˆë‹¤).

## **Preemption**

- ìš°ì„ ìˆœìœ„ëŠ” ë” ì¤‘ìš”í•œ ì›Œí¬ë¡œë“œë¥¼ ë¨¼ì € ì˜ˆì•½í•˜ê³  ë§ˆì§€ë§‰ì— í‡´ê±°í•˜ë„ë¡ ì›Œí¬ë¡œë“œ ìˆœìœ„ë¥¼ ë§¤ê¸°ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ í´ëŸ¬ìŠ¤í„°ì— ì¼ì • ê¸°ê°„ ë™ì•ˆ ì¶©ë¶„í•œ ìì›ì´ ë¶€ì¡±í•˜ê³ , ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ í¬ë“œëŠ” ë³´ë¥˜ ì¤‘ì¸ ìƒíƒœë¡œ ë‚¨ì•„ ìˆëŠ” ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©°, ìš°ì„ ìˆœìœ„ê°€ ë‚®ì€ í¬ë“œëŠ” ì´ë¯¸ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤.
- ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ì›Œí¬ë¡œë“œê°€ ìš©ëŸ‰ì„ í™•ë³´í•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ìš°ì„ ìˆœìœ„ê°€ ë‚®ì€ ì›Œí¬ë¡œë“œë¥¼ ì‚¬ì „ì— ë²”í”„í•˜ê³  ì‹¶ë‹¤ë©´, ë‹¤ìŒ ëª©ë¡ê³¼ ê°™ì´ PriorityClassì˜ **PreemptionPolicy** í•„ë“œë¥¼ ë³€ê²½í•˜ì—¬ Preemption ë™ì‘ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```bash
# A high priority class definition that will preempt lower-priority running Pods
cat << EOF | kubectl apply -f -
apiVersion: scheduling.k8s.io/v1
kind: PriorityClass
metadata:
  name: high-priority-preemption
value: 1000000
preemptionPolicy: PreemptLowerPriority
globalDefault: false
description: "Critical services."
EOF

# í™•ì¸
kubectl get priorityclass
NAME                       VALUE        GLOBAL-DEFAULT   AGE     PREEMPTIONPOLICY
high-priority              1000000      false            6m41s   Never
high-priority-preemption   1000000      false            8s      PreemptLowerPriority
system-cluster-critical    2000000000   false            16m     PreemptLowerPriority
system-node-critical       2000001000   false            16m     PreemptLowerPriority

```

- ë‹¤í–‰íˆë„ KubernetesëŠ” ë°°í¬ ë˜ëŠ” ê¸°íƒ€ ê´€ë¦¬ ì‘ì—… ë¶€í•˜ ìœ í˜•ì— ì†í•˜ëŠ” ê²½ìš° í‡´ê±°ë‚˜ ì„ ì ìœ¼ë¡œ ì¸í•´ ë…¸ë“œì—ì„œ ì œê±°ëœ í¬ë“œì— ëŒ€í•´ ìŠì§€ ì•ŠìŠµë‹ˆë‹¤.
- ì´ í¬ë“œë“¤ì€ ëŒ€ê¸° ì¤‘ ìƒíƒœë¡œ ë°˜í™˜ë˜ë©°, ì¶©ë¶„í•œ ìš©ëŸ‰ì´ í™•ë³´ë˜ë©´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ì¼ì •ì´ ë³€ê²½ë  ê²ƒì…ë‹ˆë‹¤.
- ì´ê²ƒì´ ë°”ë¡œ **Deployment**ì™€ ê°™ì€ **ì›Œí¬ë¡œë“œ êµ¬ì„± ìš”ì†Œë¥¼ í•­ìƒ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ë˜ ë‹¤ë¥¸ ì¤‘ìš”í•œ ì´ìœ **ì…ë‹ˆë‹¤. ì´ë ‡ê²Œ ì œê±°ëœ ë…ë¦½í˜• í¬ë“œëŠ” ì¼ì •ì´ ë³€ê²½ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

**WHEN TO USE PRIORITY AND PREEMPTION**

- ìš°ì„ ìˆœìœ„ì™€ ì„ ì ì€ ìœ ìš©í•œ ì¿ ë²„ë„¤í‹°ìŠ¤ íŠ¹ì§•ì´ë©°, í‡´ê±°ì™€ ìŠ¤ì¼€ì¤„ë§ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë•Œë¬¸ì— ì´í•´í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
- ëª¨ë“  ë°°í¬ë¥¼ ìš°ì„ ìˆœìœ„ë¡œ ì„¤ì •í•˜ëŠ” ë° ë„ˆë¬´ ë§ì€ ì‹œê°„ì„ íˆ¬ìí•˜ê¸° ì „ì—, ê°€ì¥ ì¤‘ìš”í•œ êµ¬ì„±ì¸ Pod ìš”ì²­ê³¼ ì œí•œì´ ì ì ˆí•œì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ ìš°ì„ ì…ë‹ˆë‹¤.
- ë§ì€ ë°°í¬ë¥¼ ì €ê¸€ë§í•˜ê³  ì˜¤ë²„ì»¤ë°‹ì„ í†µí•´ í´ëŸ¬ìŠ¤í„°ì—ì„œ ëª¨ë“  ì˜¨ìŠ¤ì˜ ì»´í“¨íŒ…ì„ ì••ì¶•í•˜ì—¬ ë¹„ìš©ì„ ì ˆê°í•˜ê³ ì í•  ë•Œ ìš°ì„ ìˆœìœ„ì™€ ì„ ì ì´ ì‹¤ì œë¡œ ì‘ìš©í•©ë‹ˆë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” ë¦¬ì†ŒìŠ¤ ê²½ìŸì„ í•´ê²°í•˜ê¸° ìœ„í•´ í¬ë“œì˜ ìƒëŒ€ì  ì¤‘ìš”ì„±ì„ ì•Œë¦´ ìˆ˜ ìˆëŠ” ë°©ë²•ì´ í•„ìš”í•©ë‹ˆë‹¤.
- **ì´ ë””ìì¸ë¶€í„° ì‹œì‘í•˜ëŠ” ê²ƒì€ ì¶”ì²œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì™œëƒí•˜ë©´ ë‹¹ì‹ ì€ ë‹¨ì§€ ë³µì¡ì„±ì„ ë”í•˜ê³  ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.**
- ì‹œì‘í•˜ëŠ” ë” ê°„ë‹¨í•œ ë°©ë²•ì€ ëª¨ë“  ì›Œí¬ë¡œë“œë¥¼ ì¶©ë¶„íˆ ì˜ˆì•½í•˜ê³  ë‚˜ì¤‘ì— ì‘ì—…ì„ ë¯¸ì„¸ ì¡°ì •í•˜ì—¬ í´ëŸ¬ìŠ¤í„°ì—ì„œ ë” ë§ì€ íš¨ìœ¨ì„±ì„ í™•ë³´í•  ìˆ˜ ìˆë„ë¡ ì¶©ë¶„í•œ ë¦¬ì†ŒìŠ¤ë¥¼ í• ë‹¹í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ë‹¤ì‹œ í•œ ë²ˆ, ì¤‘ìš”í•œ ì„œë¹„ìŠ¤ì˜ ì„±ëŠ¥ì„ ë³´ì¥í•˜ëŠ” ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•ì€ **ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì ì ˆí•˜ê²Œ ì„¤ì •í•˜ê³  í´ëŸ¬ìŠ¤í„°ì— ëª¨ë“  ìš”ì²­ì„ ìŠ¤ì¼€ì¤„ë§í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ë…¸ë“œë¥¼ í™•ë³´**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.


### 5.2 Calculating Pod resources
ë°˜ë³µ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰(CPU, Mem ì¸¡ì •) - ì´ˆê¸°, ë¶€í•˜ ë°œìƒ(normal, high), ë¶€í•˜ ì¢…ë£Œ í›„ ë“±
- ì´ì „ ì„¹ì…˜ì—ì„œëŠ” ê°€ì¥ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ìš´ì˜ í™˜ê²½ì„ ìœ„í•´ ì ì ˆí•œ ë¦¬ì†ŒìŠ¤ ìš”ì²­ê³¼ ì œí•œì„ ì„¤ì •í•˜ëŠ” ê²ƒì´ ì™œ ì¤‘ìš”í•œì§€ ë…¼ì˜í–ˆìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ ê°€ì¥ ì¢‹ì€ ê°’ì´ ë¬´ì—‡ì¸ì§€ ì–´ë–»ê²Œ ê²°ì •í•  ìˆ˜ ìˆì„ê¹Œìš”? í•µì‹¬ì€ í¬ë“œë¥¼ ì‹¤í–‰í•˜ê³  ê´€ì°°í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- KubernetesëŠ” ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ëª¨ë‹ˆí„°ë§ ë„êµ¬ì¸ kubectl ìƒë‹¨ì„ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤. ì´ ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í¬ë“œì™€ ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì˜¬ë°”ë¥¸ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì„¤ì •í•˜ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•  ì‚¬í•­ì€ í¬ë“œì— ì§‘ì¤‘í•  ê²ƒì…ë‹ˆë‹¤.
- ë¨¼ì €, ì§€ë‚˜ì¹˜ê²Œ ë†’ì€ ìì› ìš”ì²­ìœ¼ë¡œ í¬ë“œë¥¼ ë°°í¬í•˜ì„¸ìš”.
- ì´ í¬ë“œëŠ” ì´ë¯¸ í”„ë¡œë•ì…˜ì— ë°°í¬ë˜ì–´ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê²°êµ­, í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ê³¼ëŒ€í‰ê°€í•˜ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ ì„±ëŠ¥ ë©´ì—ì„œëŠ” ê´œì°®ì§€ë§Œ(ì˜ˆì‚° ë©´ì—ì„œëŠ” í•­ìƒ ë¬¸ì œê°€ ë˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤).
- ì´ ì—°ìŠµì˜ ëª©í‘œëŠ” ì‹œì‘ì„ ë†’ê²Œ í•˜ê³ , í¬ë“œì˜ ì‹¤ì œ ì‚¬ìš©ëŸ‰ì„ ê´€ì°°í•œ ë‹¤ìŒ, ìš”ì²­ì„ ë‹¤ì‹œ í˜ì–´ë§í•˜ì—¬ ì ì ˆí•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì œê³µí•˜ê³  ë‚­ë¹„ë¥¼ í”¼í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- í¬ë“œì— í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ì˜ ì–‘ì„ ì¶©ë¶„íˆ íŒŒì•…í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ëŠ” ë…¸ë“œì˜ ëª¨ë“  ì˜ˆë¹„ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì œí•œì„ ì„¤ì •í•˜ì§€ ì•Šì€ ìƒíƒœë¡œ ë‘ëŠ” ê²ƒì´ ê°€ì¥ ì¢‹ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ê²ƒì´ ì¼ë¶€ ìì› ìš”ì²­ì„ ì„¤ì •í•  í•„ìš”ì„±ì„ ì™„ì „íˆ í•´ê²°í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. ì²˜ìŒì—ëŠ” í•„ìš”í•œ ìš©ëŸ‰ë³´ë‹¤ ì „ìš© ìš©ëŸ‰ì„ í• ë‹¹ë°›ëŠ” ê²ƒì„ ì„ í˜¸í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

```bash
# ì‹¤ìŠµ ì§„í–‰~
cat << EOF | kubectl apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: timeserver
spec:
  replicas: 1
  selector:
    matchLabels:
      pod: timeserver-pod
  template:
    metadata:
      labels:
        pod: timeserver-pod
    spec:
      containers:
      - name: timeserver-container
        image: docker.io/wdenniss/timeserver:3
        resources:
          requests:
            cpu: 200m
            memory: 250Mi
---
apiVersion: v1
kind: Service
metadata:
  name: timeserver
spec:
  selector:
    pod: timeserver-pod
  ports:
  - port: 80
    targetPort: 80
    protocol: TCP
    nodePort: 30001
  type: NodePort
EOF

# íŒŒë“œ ëª¨ë‹ˆí„°ë§
kubectl top pods
while true; do kubectl top pods ; sleep 2; echo ; date; done;

# Apache Bench íˆ´ì„ í†µí•´ ë¶€í•˜ ë°œìƒ : 20ê°œì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ 10,000ê°œì˜ ìš”ì²­ì„ ìƒì„±
curl -s 127.0.0.1:30001
ab -n 10000 -c 20 http://127.0.0.1:30001/
ab -n 50000 -c 20 http://127.0.0.1:30001/


# top pods ê²°ê³¼ CPU ì‚¬ìš©ëŸ‰ ì¦ê°€ í™•ì¸
Thu Mar  6 13:51:01 KST 2025
NAME                          CPU(cores)   MEMORY(bytes)   
timeserver-84d9f58b9b-lzjf8   4m           45Mi            

...

Thu Mar  6 13:51:05 KST 2025
NAME                          CPU(cores)   MEMORY(bytes)   
timeserver-84d9f58b9b-lzjf8   338m         47Mi            

...      

Thu Mar  6 13:51:20 KST 2025
NAME                          CPU(cores)   MEMORY(bytes)   
timeserver-84d9f58b9b-lzjf8   891m         45Mi            

# ì‹¤ìŠµ í›„ ì‚­ì œ
kubectl delete deploy,svc timeserver
```

- kubectl ìƒë‹¨ í¬ë“œë¥¼ ì‹¤í–‰í•˜ê³ (ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ 1~2ë¶„ ì •ë„ ê¸°ë‹¤ë ¤ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤) ìŠ¤**íƒ€íŠ¸ì—… ë¦¬ì†ŒìŠ¤, íŠ¹íˆ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ê¸°ë¡**í•©ë‹ˆë‹¤.
- ë²„ìŠ¤íŠ¸ ê°€ëŠ¥í•œ QoSë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì´ ì–‘ì´ í•˜í•œì„ ì´ë¯€ë¡œ Podê°€ ë¶€íŒ…í•´ì•¼ í•˜ëŠ” ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ìŠ¤ëƒ…ìƒ·ì„ ì‘ì„±í•˜ëŠ” ê²ƒì´ ìœ ìš©í•©ë‹ˆë‹¤.
- ì´ì œ ì‹¤ì œ ì‚¬ìš©ì„ ì‹œë®¬ë ˆì´ì…˜í•  ìˆ˜ ìˆì„ ë§Œí¼ í¬ë“œì—ì„œ ì¶©ë¶„í•œ ë¶€í•˜ë¥¼ ìœ ë„í•˜ì„¸ìš”.
- Apacheì— ì„¤ì¹˜ëœ **Apache Bench**ì™€ ê°™ì€ ì„±ëŠ¥ ë„êµ¬ëŠ” ì—¬ê¸°ì— ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë‹¤ìŒì€ **20ê°œì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ 10,000ê°œì˜ ìš”ì²­ì„ ìƒì„±í•˜ëŠ” Apache Bench ëª…ë ¹**ì˜ ì˜ˆì‹œì…ë‹ˆë‹¤.
- ì¼ë°˜ì ìœ¼ë¡œ ì´ **í…ŒìŠ¤íŠ¸ë¥¼ ì ì‹œ(ì˜ˆ: 5ë¶„) ë™ì•ˆ ì‹¤í–‰**í•˜ì—¬ ê³ ìˆ˜ë¶„ í‘œì‹œë¥¼ ë” ì‰½ê²Œ ê´€ì°°í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤:
- í¬ë“œê°€ ì •ìƒì ì¸ ìƒì‚° ë¶€í•˜ë¥¼ ë°›ëŠ” ê²ƒë„ ê´€ì°°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í¬ë“œê°€ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ íŒŒì•…í•  ë•Œê¹Œì§€ ìƒì‚°ì— ì§€ë‚˜ì¹˜ê²Œ ì œì•½ì„ ê°€í•˜ì§€ ì•Šìœ¼ë ¤ë©´ ë¨¼ì € ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ê³¼ëŒ€í‰ê°€í•œ ë‹¤ìŒ ì‹¤ì œ ì‚¬ìš©ëŸ‰ì„ ì¸¡ì •í•˜ëŠ” ê²ƒë¶€í„° ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.
- ì‹¤ì œ ìš”êµ¬ ì‚¬í•­ì„ ì˜ íŒŒì•…í•œ í›„ì—ëŠ” ë‚˜ì¤‘ì— ìš”ì²­ ì‚¬í•­ì„ ì¡°ì •í•˜ê³  ì ì ˆí•œ í¬ê¸°ë¡œ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í¬ë“œê°€ ë¡œë“œëœ ìƒíƒœì—ì„œ ì¿ ë²¡í‹€ ìƒë‹¨ í¬ë“œë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•©ë‹ˆë‹¤(ìµœì‹  ê°’ì„ ë°˜ì˜í•˜ëŠ” ë° 1~2ë¶„ ì •ë„ ê±¸ë¦´ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë¡œë“œ ì‹œë®¬ë ˆì´ì…˜ì„ ê³„ì† ì‹¤í–‰í•˜ì„¸ìš”).
- ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ì´ ë³´ì¼ ê²ƒì…ë‹ˆë‹¤:
- ìì²´ Podì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ê°€ ì™„ë£Œë˜ë©´ í‘œ 5.1ì— í‘œì‹œëœ ê°’ê³¼ ê°™ì€ ê°’ì„ ê°€ì ¸ì•¼ í•©ë‹ˆë‹¤(ì´ í‘œì˜ ë°ì´í„°ëŠ” ìˆœì „íˆ ì˜ˆì‹œì…ë‹ˆë‹¤).
![alt text](image-9.png)

- ì´ ê³¼ì •ì„ ëª‡ ë²ˆ ë” ë°˜ë³µí•˜ê³  ë‹¤ì–‘í•œ ë¶€í•˜(ì˜ˆ: ë‚®ì€ íŠ¸ë˜í”½, ì •ìƒ íŠ¸ë˜í”½, ë†’ì€ íŠ¸ë˜í”½)ì™€ ì‹œê°„ í”„ë ˆì„ì—ì„œ Pod ê°’ì„ ì–»ëŠ” ê²ƒì´ ìœ ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì—¬ëŸ¬ ì‹œê°„ëŒ€(ì˜ˆ: ë¶€íŒ… ì§í›„, ë¶€íŒ… í›„ 1ì‹œê°„, ë¶€íŒ… í›„ 1ì¼)ëŠ” ì ì¬ì ì¸ ì‚¬ìš©ëŸ‰ ì¦ê°€(ì˜ˆ: ë©”ëª¨ë¦¬ ëˆ„ìˆ˜)ë¥¼ ê³ ë ¤í•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.
- ê·¸ë˜ì„œ ê²°êµ­ì—ëŠ” í‘œ 5.2ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
![alt text](image-10.png)

### **5.2.1 Setting memory requests and limits - í•˜í•œì„ +ë²„í¼(ìµœì†Œ10%), ìƒí•œì„ (ë™ì¼) â†’ ì¬ì‹œì‘ì´ ë‚˜ì„ìˆ˜ ìˆìŒ**
- ì´ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆë‹¤ë©´ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì–´ë–»ê²Œ ì„¤ì •í•´ì•¼ í• ê¹Œìš”? ìš°ì„ , ì´ì œ ë©”ëª¨ë¦¬ì— ëŒ€í•œ ì ˆëŒ€ í•˜í•œì„ ì´ 400 MiBì…ë‹ˆë‹¤.
- ë¦¬ì†ŒìŠ¤ ìš”ì²­ë§Œ ë°›ì„ ìˆ˜ ìˆê³  Podê°€ ë¶€í•˜ ìƒíƒœì—ì„œ 400 MiBë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆê¸° ë•Œë¬¸ì—, ì´ ê°’ì„ ë‚®ì¶”ë©´ Podê°€ OOMí‚¬(ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¢…ë£Œë¨)ë  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
- ë¦¬ì†ŒìŠ¤ í•œë„ê°€ ë” ë†’ê²Œ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´ ë°”ë¡œ ë³´ì§€ ëª»í•  ìˆ˜ë„ ìˆì§€ë§Œ, í•„ìš”í•  ë•Œ ì—¬ë¶„ì˜ ìš©ëŸ‰ì— ì˜ì¡´í•˜ê³  ì‹¶ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.
- 400 MiBê°€ ì˜¬ë°”ë¥¸ ìš”ì²­ì¸ê°€ìš”? ì•„ë§ˆë„ ì•„ë‹ ê²ƒì…ë‹ˆë‹¤.
- ë¨¼ì €, 10%ì™€ ê°™ì€ ë²„í¼ë¥¼ í™•ì‹¤íˆ ê°–ê³  ì‹¶ì„ ê²ƒì…ë‹ˆë‹¤. ë˜í•œ, í•œ ì‹œê°„ í›„ì— 505 MiBê°€ ì‚¬ìš©ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë²„í¼ë¥¼ ê³ ë ¤í•˜ê¸° ì „ì— ì´ê²ƒì´ ë” ë‚˜ì€ ì‹œì‘ í•˜í•œì„ ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í•˜ì§€ë§Œ 600 MiBê°€ í•„ìš”í• ê¹Œìš”? í•˜ë£¨ê°€ ì§€ë‚œ í›„ ì–´ë”˜ê°€ì— ëˆ„ìˆ˜ê°€ ìˆì—ˆê¸° ë•Œë¬¸ì— í¬ë“œê°€ ê·¸ë§Œí¼ í•„ìš”í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œì•˜ìŠµë‹ˆë‹¤. ì´ ë‹µë³€ì€ ìƒí™©ì— ë”°ë¼ ë‹¤ë¦…ë‹ˆë‹¤.
- ì´ ìƒí•œì„ ì„ ì„¤ì •í•˜ë©´ í¬ë“œê°€ í•˜ë£¨ ë™ì•ˆ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤ëŠ” ìì‹ ê°ì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ Kubernetesê°€ ì¶©ëŒí•œ ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ì¬ì‹œì‘í•œ ë•ë¶„ì—, ì‹œìŠ¤í…œì´ í•˜ë£¨ í›„ì— ë©”ëª¨ë¦¬ë¥¼ íšŒìˆ˜í•˜ê¸° ìœ„í•´ ëˆ„ìˆ˜ê°€ ë°œìƒí•˜ëŠ” í”„ë¡œì„¸ìŠ¤ë¥¼ ì¬ë¶€íŒ…í•˜ëŠ” ê²ƒì€ ê´œì°®ì„ ìˆ˜ë„ ìˆê³ , ì‹¬ì§€ì–´ ë°”ëŒì§í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
    
```
ğŸ‘‰ğŸ»    **When memory leaks are OK** - [Blog](https://instagram-engineering.com/dismissing-python-garbage-collection-at-instagram-4dca40b29172)
    
- Instagramì€ CPU ì„±ëŠ¥ì„ 10% í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ Pythonì—ì„œ ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ì„ ë¹„í™œì„±í™”í•œ ê²ƒìœ¼ë¡œ ìœ ëª…í•©ë‹ˆë‹¤.
- ì´ê²ƒì´ ì•„ë§ˆë„ ëª¨ë“  ì‚¬ëŒì„ ìœ„í•œ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ê³ ë ¤í•´ì•¼ í•  í¥ë¯¸ë¡œìš´ íŒ¨í„´ì…ë‹ˆë‹¤.
- í”„ë¡œì„¸ìŠ¤ê°€ ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ë¶€í’€ì–´ ì˜¤ë¥´ê³  ì¬ë¶€íŒ…ë˜ëŠ” ê²ƒì´ ì •ë§ ì¤‘ìš”í•œê°€ìš”? ëª¨ë“  ê²ƒì´ ìë™ìœ¼ë¡œ ì¼ì–´ë‚˜ê³  ìˆ˜ì²œ ê°œì˜ ë³µì œë³¸ì´ ìˆëŠ” ê²½ìš°? ê·¸ë ‡ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
- KubernetesëŠ” ì¶©ëŒí•œ ì»¨í…Œì´ë„ˆë¥¼ ìë™ìœ¼ë¡œ ì¬ì‹œì‘í•©ë‹ˆë‹¤(ë©”ëª¨ë¦¬ ë¶€ì¡± ìƒíƒœë¡œ ì¸í•´ ì‹œìŠ¤í…œì´ ì»¨í…Œì´ë„ˆë¥¼ ì œê±°í•˜ëŠ” ê²½ìš° í¬í•¨). ì´ë¥¼ í†µí•´ ì´ëŸ¬í•œ íŒ¨í„´ì„ êµ¬í˜„í•˜ëŠ” ê²ƒì´ ë¹„êµì  ì‰½ìŠµë‹ˆë‹¤.
- ì² ì €í•œ ì¡°ì‚¬ ì—†ì´ ì´ ì „ëµì„ ì¶”ì²œí•˜ì§€ëŠ” ì•Šê² ì§€ë§Œ, ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŠë¦° ìœ ì¶œì´ ìˆë‹¤ë©´ ê°€ì¥ ìš°ì„ ìˆœìœ„ê°€ ë†’ì€ ë²„ê·¸ê°€ ì•„ë‹ ìˆ˜ë„ ìˆë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.
- ì¤‘ìš”í•œ ê²ƒì€ ì»¨í…Œì´ë„ˆë¥¼ ë¶€íŒ…í•˜ê³  ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì¶©ë¶„í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ì œê³µí•´ì•¼ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤.
- ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ëˆ„êµ¬ì—ê²Œë‚˜ ì¬ë¯¸ì—†ëŠ” OOMKill ì¶©ëŒ ë£¨í”„ì— íœ˜ë§ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìê°€ ë³¼ ìˆ˜ ìˆëŠ” ì¥ì• ë¥¼ ë°©ì§€í•˜ë ¤ë©´ ë‹¤ìŒ ì„¹ì…˜ì—ì„œ ì„¤ëª…í•˜ëŠ” ì¶©ë¶„í•œ ë³µì œë³¸ì„ ë³´ìœ í•˜ëŠ” ê²ƒë„ ì¤‘ìš”í•©ë‹ˆë‹¤.
```
    
- ìˆ˜ì§‘í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë“œ ì¤‘ì¸ Podì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ í™•ì¸í•˜ì—¬ **í•˜í•œì„ ì„ ì°¾ê³  í•©ë¦¬ì ì¸ ë²„í¼(ìµœì†Œ 10%)ë¥¼ ì¶”ê°€**í•˜ì„¸ìš”.
- ì´ ì˜ˆì œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ë©´ 505 MiB * 1.1 555 MiBë¥¼ ì„ íƒí•  ê²ƒì…ë‹ˆë‹¤.
- í¬ë“œë¥¼ ìµœì†Œí•œ í•œ ì‹œê°„ ë™ì•ˆ ë¡œë“œ ìƒíƒœì—ì„œ ì‹¤í–‰í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì¶©ë¶„í•˜ë‹¤ëŠ” ê²ƒì„ ì•Œê³  ê³„ì‹¤ ê²ë‹ˆë‹¤. ì—¬ìœ ê°€ ì¢€ ìˆìŠµë‹ˆë‹¤.
- ì˜ˆì‚°ê³¼ ë¦¬ìŠ¤í¬ í”„ë¡œí•„ì— ë”°ë¼ ì´ ìˆ˜ì¹˜ë¥¼ ì ì ˆíˆ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(ë†’ì„ìˆ˜ë¡ ë¦¬ìŠ¤í¬ëŠ” ë‚®ì§€ë§Œ ë¹„ìš©ì€ ë” ë§ì´ ë“­ë‹ˆë‹¤).
- ë”°ë¼ì„œ ìš”ì²­ì€ ìµœì†Œí•œ í¬ë“œì˜ ì•ˆì •ì ì¸ ìƒíƒœë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.
- ë©”ëª¨ë¦¬ ì œí•œì€ ì–´ë–»ê²Œ ë˜ë‚˜ìš”? ë°ì´í„°ê°€ ê²¬ê³ í•˜ê³  ëª¨ë“  ê²½ìš°(ì˜ˆ: ê´€ì°° ì¤‘ì— ì‹¤í–‰ë˜ì§€ ì•Šì€ ê³ ë©”ëª¨ë¦¬ ì½”ë“œ ê²½ë¡œê°€ ì—†ëŠ” ê²½ìš°)ë¥¼ í¬í•¨í•œë‹¤ê³  ê°€ì •í•˜ë©´ í•˜ë£¨ ê°’ë³´ë‹¤ ë„ˆë¬´ ë†’ê²Œ ì„¤ì •í•˜ì§€ ì•Šì„ ê²ƒì…ë‹ˆë‹¤.
- í•˜ë£¨ ë™ì•ˆ í¬ë“œì— í•„ìš”í•œ ë©”ëª¨ë¦¬ ì–‘ì„ ì´ë¯¸ ì¸¡ì •í–ˆê¸° ë•Œë¬¸ì— **ê³¼ë„í•œ ì œí•œ(ì˜ˆ: ì œí•œë³´ë‹¤ ë‘ ë°° ì´ìƒ ë†’ìŒ)ì„ ë‘ëŠ” ê²ƒì€ í° ë„ì›€ì´ ë˜ì§€ ì•ŠìŠµë‹ˆ**ë‹¤.
- **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ê°€ ë°œìƒí•œ ê²½ìš°, í¬ë“œê°€ ê³¼ë„í•˜ê²Œ ì»¤ì§€ë„ë¡ í•˜ëŠ” ëŒ€ì‹  í•œê³„ì— ë„ë‹¬í•˜ë©´ ì‹œìŠ¤í…œì´ í¬ë“œë¥¼ ì¬ì‹œì‘í•˜ëŠ” ê²ƒì´ ë” ë‚˜ì„ ìˆ˜** ìˆìŠµë‹ˆë‹¤.
- ëŒ€ì•ˆì€ **ë‹¨ìˆœíˆ ì œí•œì„ ë³´ì¥ëœ QoS í´ë˜ìŠ¤ì— ëŒ€í•œ ìš”ì²­ê³¼ ë™ì¼í•˜ê²Œ ì„¤ì •**í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ì´ ì „ëµì€ ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ë‹¤ë¥¸ ê¸°ëŠ¥ê³¼ ìƒê´€ì—†ì´ íŒŸì˜ ì§€ì†ì ì¸ ì„±ëŠ¥ì„ ì œê³µí•˜ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.
- ì´ ê²½ìš°, ìš”ì²­ëœ ì–‘ì„ ì´ˆê³¼í•˜ëŠ” ìˆœê°„ Podê°€ ì¢…ë£Œë˜ë¯€ë¡œ **Podì— ì•½ê°„ì˜ ì¶”ê°€ ë¦¬ì†ŒìŠ¤ ë²„í¼ë¥¼ ì œê³µ**í•´ì•¼ í•©ë‹ˆë‹¤.

### **5.2.2 Setting CPU requests and limits - í•˜í•œì„ +ë²„í¼(ìµœì†Œ10%), ìƒí•œì„ (ë¯¸ì„¤ì •, ì¤‘ìš” appì€ ë™ì¼)**
- ë©”ëª¨ë¦¬ì™€ ë‹¬ë¦¬ **CPUëŠ” ì••ì¶•**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Unlike memory, **CPU is compressible**.
- ì¦‰, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•„ìš”í•œ ëª¨ë“  CPU ë¦¬ì†ŒìŠ¤ë¥¼ í™•ë³´í•˜ì§€ ëª»í•˜ë©´ ì‹¤í–‰ ì†ë„ê°€ ëŠë ¤ì§‘ë‹ˆë‹¤.
- ì´ê²ƒì€ **ë©”ëª¨ë¦¬ì™€ëŠ” ìƒë‹¹íˆ ë‹¤ë¦…ë‹ˆë‹¤: ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ë©´ ì¶©ëŒ**í•  ê²ƒì…ë‹ˆë‹¤.
- ì—¬ì „íˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì¶©ë¶„í•œ CPU ë¦¬ì†ŒìŠ¤ë¥¼ ì œê³µí•˜ê³  ì‹¶ì„ ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
- ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì„±ëŠ¥ì´ ì €í•˜ë˜ì§€ë§Œ ë©”ëª¨ë¦¬ë§Œí¼ ì¶”ê°€ ìš©ëŸ‰ì˜ ë²„í¼ê°€ í•„ìš”í•˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤.
- í‘œ 5.2ì— í‘œì‹œëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì˜ˆì œ ë°ì´í„°ì—ì„œ ì•ˆì • ìƒíƒœê°€ CPUì˜ ì•½ 200mCPUì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ê²ƒì´ ë‹¹ì‹ ì˜ CPU ìš”ì²­ì— ì¢‹ì€ ì¶œë°œì ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤.
- ë¹„ìš©ì„ ì ˆì•½í•˜ê³  ì„±ëŠ¥ì„ ì €í•˜ì‹œí‚¤ëŠ” ë° ë¬¸ì œê°€ ì—†ë‹¤ë©´ ì¡°ê¸ˆ ë” ë‚®ê²Œ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- CPU í•œê³„ëŠ” Kubernetesê°€ ìì› íš¨ìœ¨ì„±ì„ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ì˜ì—­ì…ë‹ˆë‹¤. ì´ëŠ” ìš”ì²­ë³´ë‹¤ ë†’ì€ í•œê³„ë¥¼ ì„¤ì •í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì‚¬ì´í´ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
- ë©”ëª¨ë¦¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ KubernetesëŠ” ìš”ì²­ëœ CPUë§Œ ë³´ì¥í•˜ì§€ë§Œ, **ì¢…ì¢… ë…¸ë“œì—ì„œ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ìš©ëŸ‰ì„ í™œìš©í•˜ì—¬ Podê°€ ì¡°ê¸ˆ ë” ë¹ ë¥´ê²Œ ì‹¤í–‰ë˜ë„ë¡ í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.**
- ì™¸ë¶€ ì¢…ì†ì„±(ì˜ˆ: ë°ì´í„°ë² ì´ìŠ¤ê°€ ì‘ë‹µí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ëŠ” ë“±)ì„ ê¸°ë‹¤ë¦¬ëŠ” ë° ë§ì€ ì‹œê°„ì„ í• ì• í•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš°, ë…¸ë“œì— ì—¬ë¶„ì˜ CPU ìš©ëŸ‰ì´ ìˆëŠ” ê²½ìš°ê°€ ë§ìœ¼ë©°, ì´ëŠ” í™œì„± ìš”ì²­ì´ ì´ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë©”ëª¨ë¦¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ìš”ì²­ë³´ë‹¤ ë†’ì€ ì œí•œ ì„¤ì •(ì¦‰, ë²„ìŠ¤íŠ¸ ê°€ëŠ¥í•œ QoS í´ë˜ìŠ¤)ì˜ ë‹¨ì ì€ ì„±ëŠ¥ì´ ì¼ì •í•˜ì§€ ì•Šë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ë¹ˆ ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ë²„ìŠ¤íŠ¸ ê°€ëŠ¥í•œ í¬ë“œëŠ” í¬ë“œë¡œ ì±„ì›Œì§„ ë…¸ë“œë³´ë‹¤ í›¨ì”¬ ë” ë§ì€ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ìœ í•˜ê²Œ ë©ë‹ˆë‹¤.
- ì¼ë°˜ì ìœ¼ë¡œ ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ìš©ëŸ‰ì„ ì†Œë¹„í•˜ì—¬ íŠ¸ë˜í”½ í­ë°œì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê²ƒì€ ì¢‹ì§€ë§Œ, **ì§€ì†ì ì¸ ì„±ëŠ¥ì´ ì¤‘ìš”í•˜ë‹¤ë©´ ìš”ì²­ê³¼ ë™ì¼í•œ ì œí•œì„ ì„¤ì •í•˜ëŠ” ê²ƒì´ ë°”ëŒ**ì§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### **5.2.3 Reducing costs by overcommitting CPU - ë¹„ìš© ì ˆê° ì‹œ CPU ì˜¤ë²„ì»¤ë°‹**
- ë¹„ìš©ì„ ì ˆê°í•˜ëŠ” í•œ ê°€ì§€ ì „ëµì€ ë…¸ë“œì˜ CPU ë¦¬ì†ŒìŠ¤ë¥¼ ê³¼ë„í•˜ê²Œ ì˜¤ë²„ì»¤ë°‹í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ì´ ì˜¤ë²„ì»¤ë°‹ì€ CPU ìš”ì²­ì„ ë‚®ì€ ê°’(Podê°€ ì‹¤ì œë¡œ í•„ìš”ë¡œ í•˜ëŠ” ê²ƒë³´ë‹¤ ë‚®ìŒ)ìœ¼ë¡œ ì„¤ì •í•˜ì—¬, CPU ìš”ì²­ì„ ì‹¤ì œ ì‚¬ìš©ëŸ‰ìœ¼ë¡œ ì„¤ì •í•  ê²½ìš°ë³´ë‹¤ ë” ë§ì€ Podë¥¼ ë…¸ë“œì— ì£¼ì…í•¨ìœ¼ë¡œì¨ ë‹¬ì„±ë©ë‹ˆë‹¤.
- ì´ ì „ëµì€ ë¹„ìš©ì„ ì ˆê°í•˜ì§€ë§Œ ì„±ëŠ¥ ë©´ì—ì„œëŠ” ëª…ë°±í•œ ë‹¨ì ì´ ìˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ ë§¤ìš° í˜¼ì¡í•˜ë‹¤ê³  ì—¬ê²¨ì§€ëŠ” ì‘ì—… ë¶€í•˜ì˜ ê²½ìš° ë§¤ìš° ë°”ëŒì§í•œ ì „ëµì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê° ìš”ì²­ì€ í•œ ì‹œê°„ì— ëª‡ ê°œë§Œ ë°›ì„ ìˆ˜ ìˆìœ¼ë©°, ê·¸ ì‹œê°„ì—ëŠ” CPUë§Œ í•„ìš”í•©ë‹ˆë‹¤.
- ì´ëŸ¬í•œ ë°°í¬ë¥¼ ìœ„í•´ ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì€ 50m(ì½”ì–´ë‹¹ 20ê°œì˜ í¬ë“œë¥¼ ì˜ˆì•½í•  ìˆ˜ ìˆìŒ)ì˜ CPU ìš”ì²­ê³¼ 1000m(ì¼ì‹œì ìœ¼ë¡œ ì „ì²´ ì½”ì–´ë¡œ ë²„ìŠ¤íŠ¸í•  ìˆ˜ ìˆìŒ)ì˜ ì œí•œì„ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ ì‘ì—…ê³¼ ê°™ì€ ê³¼ëª°ì… ì „ëµì„ ë§Œë“œëŠ” í•µì‹¬ì€ ê¸°ê³„ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ë‹¤ë¥¸ ì‘ì—…ì´ ë¬´ì—‡ì¸ì§€ ë©´ë°€íˆ ì¸ì‹í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- **ëŒ€ë¶€ë¶„ì˜ ì›¹ì‚¬ì´íŠ¸ê°€ ëŒ€ë¶€ë¶„ ìœ íœ´ ìƒíƒœì¼ ê²ƒì´ë¼ê³  í™•ì‹ í•œë‹¤ë©´, ì´ ì ‘ê·¼ ë°©ì‹ì´ íš¨ê³¼**ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ **ëª¨ë“  í¬ë“œì˜ ì»¨í…Œì´ë„ˆê°€ í•œ ë²ˆì— í„°ì ¸ì•¼ í•˜ëŠ” ê²½ìš° ì„±ëŠ¥ì´ ì €í•˜**ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ì´ëŸ¬í•œ ìœ í˜•ì˜ ì„¤ì •ì€ ë” ì´ìƒ ì»¨í…Œì´ë„ˆê°€ ì„œë¡œ ë¶„ë¦¬ë˜ì–´ ìˆì§€ ì•ŠìŒì„ ì˜ë¯¸í•©ë‹ˆë‹¤:
- ì´ì œ ë…¸ë“œì˜ êµ¬ì„±ì„ ì¸ì§€í•˜ê³  ì´ì— ë§ê²Œ ê³„íší•´ì•¼ í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ë¬¼ë¡  ê°€ì¥ ì•ˆì „í•œ ì ‘ê·¼ ë°©ì‹ì€ ì˜¤ë²„ ì»¤ë°‹ì„ ì „í˜€ í•˜ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤. í•©ë¦¬ì ì¸ íƒ€í˜‘ì±…ì€ ë„ˆë¬´ ì˜¤ë²„ ì»¤ë°‹í•˜ì§€ ì•ŠëŠ” ê²ƒì…ë‹ˆë‹¤.
- í¬ë“œì— ë¦¬ì†ŒìŠ¤ ì œí•œì„ ìš”ì²­ë³´ë‹¤ ë†’ê²Œ ì„¤ì •í•˜ì—¬ ì•½ê°„ì˜ ì¶”ê°€ CPUë¥¼ ì œê³µí•˜ë©´ ì§€ì—° ì‹œê°„ì„ ì¤„ì´ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- ê·¸ëŸ¬ë‚˜ ì´ ì´ˆê³¼ ìš©ëŸ‰ì´ ì˜ì¡´í•˜ì§€ ì•Šë„ë¡ CPU ë¦¬ì†ŒìŠ¤ ìš”ì²­ì„ ì¶©ë¶„íˆ ë†’ê²Œ ì„¤ì •í•˜ì—¬ í•©ë¦¬ì ì¸ ê¸°ë³¸ ë¶€í•˜ë¥¼ ì²˜ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤.

### **5.2.4 Balancing Pod replicas and Internal Pod concurrency** - **íŒŒë“œ ì¥ì•  ëŒ€ì‘ ê³ ë ¤, íŒŒë“œë‚´ í”„ë¡œì„¸ìŠ¤/ì“°ë ˆë“œëŠ” ì ì • ìˆ˜**
- ì´ì œ ë¦¬ì†ŒìŠ¤ ìš”ì²­ì´ í¬ë“œì˜ ì˜ˆì•½ ë°©ì‹ê³¼ ë¦¬ì†ŒìŠ¤ í™•ë³´ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ íŒŒì•…í–ˆìœ¼ë‹ˆ **í¬ë“œ ë‚´ì—ì„œ ë™ì‹œì„±**ì„ ê³ ë ¤í•  ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.
- **Podì˜ ë™ì‹œì„±**(ì˜ˆ: **ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤/ìŠ¤ë ˆë“œ ìˆ˜**)ì€ ë¦¬ì†ŒìŠ¤ í¬ê¸°ì— ì˜í–¥ì„ ë¯¸ì¹˜ë©°, Pod ë³µì œë³¸ì„ í†µí•´ Pod ë‚´ì—ì„œ ë™ì‹œì„±ì„ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë‚´êµ¬ì„± ì¸¡ë©´ì—ì„œ **íš¨ìœ¨ì„±ì˜ ê· í˜•ì´ ê¹¨ì§‘**ë‹ˆë‹¤.
     
- ì„œë²„ì— ëŒ€í•œ ê¸ˆì „ì  ë¹„ìš©ì´ë‚˜ ì¸ìŠ¤í„´ìŠ¤ êµ¬ì„± ì‹œê°„ ë“± ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì¹˜ ë¹„ìš©ì´ ë§ì´ ë“œëŠ” í™˜ê²½ì—ì„œ ì˜¨ ê²½ìš°, ìŠ¤ë ˆë“œë‚˜ í¬í¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ë¶€ ë™ì‹œì„±ì´ ë§ì´ ì„¤ì •ë  ê°€ëŠ¥ì„±ì´ ë†’ìœ¼ë©°, ì´ëŠ” ì¢…ì¢… ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ë™ì‹œì— ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì‘ì—…ì ìˆ˜ë¡œ ì„¤ëª…ë©ë‹ˆë‹¤.     
- ì¿ ë²„ë„¤í‹°ìŠ¤ ì„¸ê³„ì—ì„œëŠ” ìì› íš¨ìœ¨ì„± ë•ë¶„ì— ë™ì‹œ ê·¼ë¬´ìë“¤ì´ ì—¬ì „íˆ ìœ ë¦¬í•©ë‹ˆë‹¤.      
- ì €ëŠ” í˜„ì¬ 10ê°œì˜ workerê°€ ìˆëŠ” Podë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ , ëŒ€ì‹  ê°ê° 1ê°œì˜ workerê°€ ìˆëŠ” 10ê°œì˜ ë³µì œë³¸ì„ ë°°í¬í•  ê²ƒì…ë‹ˆë‹¤.
- **ì»¨í…Œì´ë„ˆì˜ ë‚´ë¶€ ë™ì‹œì„±**ì€ **ë©”ëª¨ë¦¬ ì¸¡ë©´ì—ì„œ ë§¤ìš° íš¨ìœ¨**ì ì…ë‹ˆë‹¤. í¬í¬ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë°”ì´ë„ˆë¦¬ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ì˜ ì¼ë¶€ë¥¼ ê³µìœ í•˜ê³  ìŠ¤ë ˆë“œëŠ” ë” ë§ì´ ê³µìœ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
- CPUëŠ” worker ê°„ì—ë„ í’€ë§ë˜ì–´ ìˆì–´ ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì™¸ë¶€ ì¢…ì†ì„±ì„ ê¸°ë‹¤ë¦¬ëŠ” ë° ë§ì€ ì‹œê°„ì„ ì†Œë¹„í•˜ê¸° ë•Œë¬¸ì— ìœ ìš©í•©ë‹ˆë‹¤. ì´ëŠ” í•œ ë²ˆì— ë§ì€ ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì—¬ìœ  ìš©ëŸ‰ì´ ì¢…ì¢… ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤.      
- í•˜ë‚˜ì˜ í¬ë“œì—ì„œ ë™ì‹œ workerì˜ ì´ì ì„ ê· í˜• ìˆê²Œ ê³ ë ¤í•˜ë©´, **í¬ë“œì˜ ë³µì œë³¸ì´ ë§ì„ìˆ˜ë¡ ë‚´êµ¬ì„±ì´ ë›°ì–´ë‚˜ë‹¤**ëŠ” ì‚¬ì‹¤ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.      
- ì˜ˆë¥¼ ë“¤ì–´, ê·¸ë¦¼ 5.7ê³¼ ê°™ì´ ì´ 36ê°œì˜ ë™ì‹œ ì—°ê²°ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ê°ê° 18ëª…ì˜ worker ê°€ ìˆëŠ” ë‘ ê°œì˜ í¬ë“œ ë³µì œë³¸ì´ ìˆë‹¤ê³  ê°€ì •í•´ ë³´ê² ìŠµë‹ˆë‹¤.     
- **í•´ë‹¹ í¬ë“œ ì¤‘ í•˜ë‚˜ê°€ ì¶©ëŒí•˜ê±°ë‚˜(ë˜ëŠ” 4ì¥ì—ì„œ ì„¤ì •í•œ ìƒíƒœ ì ê²€ì— ì‹¤íŒ¨í•˜ì—¬ ì¬ì‹œì‘ëœ ê²½ìš°), í¬ë“œê°€ ì¬ì‹œì‘ë˜ê¸° ì „ì— ìš©ëŸ‰ì˜ ì ˆë°˜ì´ ì˜¤í”„ë¼ì¸ ìƒíƒœê°€ ë©ë‹ˆë‹¤.**    
- **ë” ë‚˜ì€ ì ‘ê·¼ ë°©ì‹ì€ ê°ê° 6ëª…ì˜ ì‘ì—…ìê°€ ìˆëŠ” 6ê°œì˜ í¬ë“œ ë³µì œë³¸ì„ ë³´ìœ í•˜ëŠ” ê²ƒì¼ ìˆ˜ ìˆìœ¼ë©°, ì»¨í…Œì´ë„ˆ ê°„ ë™ì‹œì„±ì„ ìœ ì§€í•˜ë©´ì„œ ì¤‘ë³µì„±ì„ ì¶”ê°€í•©ë‹ˆë‹¤.**
        

![alt text](image-11.png)

- ì ì ˆí•œ ê· í˜•ì„ ë§ì¶”ê¸° ìœ„í•´ ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ìì—ê²Œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•´ì•¼ í•˜ëŠ” ì´ ê·¼ë¡œì ìˆ˜ì™€ ê·¸ ì¤‘ ëˆˆì— ë„ëŠ” ì‚¬ìš©ì íš¨ê³¼ ì—†ì´ ì–¸ì œë“ ì§€ ì˜¤í”„ë¼ì¸ ìƒíƒœê°€ ë  ìˆ˜ ìˆëŠ” ê·¼ë¡œì ìˆ˜ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.
- ì´ì „ ì˜ˆì‹œë¥¼ ì‚¬ìš©í•˜ì—¬ 36ëª…ì˜ ê·¼ë¡œì ì¤‘ 16%ê°€ ë¬¸ì œê°€ ë°œê²¬ë˜ê¸° ì „ì— ì˜¤í”„ë¼ì¸ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤ê³  ê°€ì •í•˜ë©´, ë‹¨ì¼ í¬ë“œì— ì§‘ì¤‘í•  ìˆ˜ ìˆëŠ” ê·¼ë¡œìì˜ ìˆ˜ëŠ” 16%, ì¦‰ 6ëª…ì…ë‹ˆë‹¤.
- ìš”ì•½í•˜ìë©´, **í¬ë“œ ë³µì œë³¸ì´ ë§ì„ìˆ˜ë¡ ë””ìì¸ì€ ì•ˆì „í•˜ì§€ë§Œ ë¦¬ì†ŒìŠ¤ ì‚¬ìš© ì¸¡ë©´ì—ì„œëŠ” íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤.**
- ë”°ë¼ì„œ ìì‹ ì˜ ê°€ìš©ì„±ê³¼ ë¦¬ì†ŒìŠ¤ ìš”êµ¬ ì‚¬í•­ì„ ê· í˜• ìˆê²Œ ì¡°ì •í•˜ëŠ” ë°©ë²•ì„ ê³ ë ¤í•  ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.
- ë³´ìœ í•˜ê³  ìˆëŠ” í¬ë“œ ë³µì œë³¸ì˜ ìˆ˜ë¥¼ ê· í˜• ìˆê²Œ ì¡°ì •í•œ í›„, ê°€ìš©ì„±ì„ ë†’ì´ëŠ” ë˜ ë‹¤ë¥¸ ì¤‘ìš”í•œ ì†ì„±ì€ í¬ë“œê°€ ì—¬ëŸ¬ ë…¸ë“œì— ë¶„ì‚°ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.
- ê²°êµ­, ì—¬ëŸ¬ ë³µì œë³¸ì„ ìœ„í•´ ì„¤ê³„í–ˆì§€ë§Œ ëª¨ë“  ë³µì œë³¸ì´ ë™ì¼í•œ ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ëŠ” ê²½ìš° í•´ë‹¹ ë…¸ë“œê°€ ê±´ê°•ì— í•´ë¥¼ ë¼ì¹  ìˆ˜ ìˆëŠ” ë‹¨ì¼ ì¥ì•  ì§€ì ì˜ ìœ„í—˜ì´ ì—¬ì „íˆ ì¡´ì¬í•©ë‹ˆë‹¤. ë‹¤í–‰íˆë„ ëŒ€ë¶€ë¶„ì˜ Kubernetes í”Œë«í¼(êµ¬ê¸€ Kubernetes Engine í¬í•¨)ì€ ê¸°ë³¸ Pod í™•ì‚° ì •ì±…ì„ í™œì„±í™”í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ë…¸ë“œì™€ ì—¬ëŸ¬ ì˜ì—­(ì§€ì—­ í´ëŸ¬ìŠ¤í„°ì˜ ê²½ìš°)ì— Podë¥¼ í™•ì‚°ì‹œí‚µë‹ˆë‹¤.
- ì´ ê¸°ë³¸ ë™ì‘ì„ ì–»ìœ¼ë ¤ë©´ ì¼ë°˜ì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ì— ë‹¤ì–‘í•œ ì˜ì—­ì˜ ë…¸ë“œê°€ ì—¬ëŸ¬ ê°œ ìˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒìœ¼ë¡œ ì¶©ë¶„í•©ë‹ˆë‹¤
- **ë…¸ë“œ ë°°ì¹˜**ì™€ **í¬ë“œ ìŠ¤í”„ë ˆë“œ í† í´ë¡œì§€**ì— ëŒ€í•´ ë” ìì„¸íˆ ì•Œì•„ë³´ê³  ì‹¶ë‹¤ë©´, **8ì¥**ì—ì„œ ë‹¤ë¤„ë³´ê² ìŠµë‹ˆë‹¤.

# **Summary**
- Kubernetes ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ì‹œìŠ¤í…œì˜ í•µì‹¬ì— ìœ„ì¹˜í•˜ë©° ì¸í”„ë¼ì—ì„œ ë°°í¬ìš© í¬ë“œì— ì í•©í•œ í™ˆì„ ì°¾ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
- ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” íŒŸì˜ ì»¨í…Œì´ë„ˆì— ë¦¬ì†ŒìŠ¤ ìš”ì²­ì´ ì ì ˆí•˜ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ” ê²½ìš°, ì£¼ì–´ì§„ ë…¸ë“œì— ê°€ëŠ¥í•œ í•œ ë§ì€ íŒŸì„ ë§ì¶”ë ¤ê³  í•  ê²ƒì…ë‹ˆë‹¤.  
- KubernetesëŠ” Podì˜ ë¦¬ì†ŒìŠ¤ ìš”ì²­ê³¼ ì œí•œì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ í• ë‹¹, ì˜¤ë²„ ì»¤ë°‹ ë° íšŒìˆ˜ ë°©ì‹ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.   
- ë²„ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ê³¼ë„í•˜ê²Œ ì»¤ë°‹í•˜ë©´ ë¦¬ì†ŒìŠ¤ë¥¼ ì ˆì•½í•  ìˆ˜ ìˆì§€ë§Œ ì„±ëŠ¥ ë³€ë™ì„±ì´ ë°œìƒí•©ë‹ˆë‹¤.   
- ì›Œí¬ë¡œë“œì˜ ìš”ì²­ ë° ì œí•œ ì‚¬í•­ì— ë”°ë¼ ìˆ˜ì‹ ë˜ëŠ” QoSê°€ ê²°ì •ë©ë‹ˆë‹¤.
- ì›Œí¬ë¡œë“œë¥¼ ì„¤ê³„í•  ë•Œ ë³µì œë³¸ ìˆ˜ì™€ Podì˜ ë‚´ë¶€ ìŠ¤ë ˆë“œ/í”„ë¡œì„¸ìŠ¤ ì‘ì—…ì ìˆ˜ ì‚¬ì´ì—ëŠ” ê°€ìš©ì„±/ìì› ì‚¬ìš© ì ˆì¶©ì•ˆì´ ìˆìŠµë‹ˆë‹¤.
- ëŒ€ë¶€ë¶„ì˜ í”Œë«í¼ì€ ê¸°ë³¸ì ìœ¼ë¡œ Pod í™•ì‚°ì„ í™œì„±í™”í•˜ì—¬ ë³µì œë³¸ì´ ì¼ë°˜ì ìœ¼ë¡œ ë™ì¼í•œ ë…¸ë“œì— ë°°ì¹˜ë˜ì§€ ì•Šë„ë¡ í•˜ì—¬ ë‹¨ì¼ ì¥ì•  ì§€ì ì„ ë°©ì§€í•©ë‹ˆë‹¤. í´ëŸ¬ìŠ¤í„°ì— ë…¸ë“œê°€ ëª‡ ê°œ ìˆëŠ”ì§€ í™•ì¸í•˜ì—¬ ë” ë†’ì€ ê°€ìš©ì„±ì„ ë‹¬ì„±í•˜ì„¸ìš”.   
